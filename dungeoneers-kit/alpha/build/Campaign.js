var t=Object.defineProperty,e=Object.defineProperties,n=Object.getOwnPropertyDescriptors,s=Object.getOwnPropertySymbols,a=Object.prototype.hasOwnProperty,r=Object.prototype.propertyIsEnumerable,l=(e,n,s)=>n in e?t(e,n,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[n]=s,i=(t,e)=>{for(var n in e||(e={}))a.call(e,n)&&l(t,n,e[n]);if(s)for(var n of s(e))r.call(e,n)&&l(t,n,e[n]);return t},c=(t,s)=>e(t,n(s));import{S as o,i as u,s as f,e as h,t as d,f as p,L as m,g as $,h as g,c as v,d as y,j as E,k as b,a as w,l as x,x as I,b as T,U as S,N as k,O as N,_ as P,P as D,J as O,K as C,Q as A,W as V,F as z,I as B,R as H,n as R,V as q,a5 as M,a2 as j,a3 as U,C as L,a8 as F,Y as X,X as _,y as W,ab as G,ao as Y,ac as J,ak as K,$ as Q,G as Z,H as tt,ai as et,ap as nt,ae as st,a6 as at,a0 as rt,r as lt,a7 as it,aq as ct,aa as ot,a9 as ut,ar as ft,as as ht}from"./vendor.js";import{g as dt,d as pt,E as mt,t as $t,C as gt,I as vt,M as yt,S as Et,L as bt,a as wt,m as xt,G as It,b as Tt,c as St,A as kt,e as Nt,T as Pt,P as Dt,f as Ot,D as Ct,h as At,i as Vt,j as zt,k as Bt,l as Ht,n as Rt,s as qt,o as Mt}from"./index.js";import{B as jt,R as Ut,F as Lt,D as Ft,S as Xt}from"./DatasetGuard.js";import{C as _t,B as Wt}from"./SpaceBetween.js";import{F as Gt,G as Yt}from"./GenericForm.js";const Jt={id:"root",name:"DM Screen",items:[]};var Kt,Qt;(Qt=Kt||(Kt={})).HASH_REF="hashRef",Qt.NPC="npc",Qt.NOTE="note";const Zt={id:null,type:null,data:null,top:32,left:32,width:300,height:300,index:1,pinned:!1};const te={version:1,name:"New Campaign",id:null,dataset:null,currentManager:"default",settings:{optimizeTablet:!1},initiative:[],currentScreenId:"root",screens:[Jt],partyMembers:[],currentInitiativeIndex:0,initiativeRound:1,savedEncounters:[],encounters:[]},ee={id:null,name:"New party member",level:1,pp:10,conditions:[]},ne=[[25,50,75,100],[50,100,150,200],[75,150,225,400],[125,250,375,500],[250,500,750,1100],[300,600,900,1400],[250,750,1100,1700],[450,900,1400,2100],[550,1100,1600,2400],[600,1200,1900,2800],[800,1600,2400,3600],[1e3,2e3,3e3,4500],[1100,2200,3400,5100],[1250,2500,3800,5700],[1400,2800,4300,6400],[1600,3200,4800,7200],[2e3,3900,5900,8800],[2100,4200,6300,9500],[2400,4900,7300,10900],[2800,5700,8500,127e3]],se={1:300,2:600,3:1200,4:1700,5:3500,6:4e3,7:5e3,8:6e3,9:7500,10:9e3,11:10500,12:11500,13:13500,14:15e3,15:18e3,16:2e4,17:25e3,18:27e3,19:3e4,20:4e4};const ae={initiative:0,type:"manual",name:"New initiative entry",deathSaves:{fails:0,successes:0},currentHealth:0,maxHealth:0,data:null};function re(){return pt(ae)}function le(t,e,n){const s=t.slice();return s[13]=e[n],s[15]=n,s}function ie(t,e,n){const s=t.slice();return s[16]=e[n],s}function ce(t){let e,n=t[13].subsections,s=[];for(let a=0;a<n.length;a+=1)s[a]=oe(ie(t,n,a));return{c(){for(let t=0;t<s.length;t+=1)s[t].c();e=m()},l(t){for(let e=0;e<s.length;e+=1)s[e].l(t);e=m()},m(t,n){for(let e=0;e<s.length;e+=1)s[e].m(t,n);w(t,e,n)},p(t,a){if(80&a){let r;for(n=t[13].subsections,r=0;r<n.length;r+=1){const l=ie(t,n,r);s[r]?s[r].p(l,a):(s[r]=oe(l),s[r].c(),s[r].m(e.parentNode,e))}for(;r<s.length;r+=1)s[r].d(1);s.length=n.length}},d(t){S(s,t),t&&y(e)}}}function oe(t){let e,n,s,a,r=t[16].name+"";function l(){return t[10](t[16])}return{c(){e=h("div"),n=d(r),this.h()},l(t){e=$(t,"DIV",{class:!0});var s=g(e);n=v(s,r),s.forEach(y),this.h()},h(){b(e,"class","subsection svelte-1ekbfpl")},m(t,r){w(t,e,r),x(e,n),s||(a=I(e,"click",l),s=!0)},p(e,s){t=e,16&s&&r!==(r=t[16].name+"")&&T(n,r)},d(t){t&&y(e),s=!1,a()}}}function ue(t){let e,n,s,a,r,l,i,c=t[13].name+"";function o(){return t[9](t[15])}let u=t[15]===t[0]&&ce(t);return{c(){e=h("div"),n=d(c),a=p(),u&&u.c(),r=m(),this.h()},l(t){e=$(t,"DIV",{class:!0});var s=g(e);n=v(s,c),s.forEach(y),a=E(t),u&&u.l(t),r=m(),this.h()},h(){b(e,"class",s="section "+(t[15]===t[0]&&"current")+" svelte-1ekbfpl")},m(t,s){w(t,e,s),x(e,n),w(t,a,s),u&&u.m(t,s),w(t,r,s),l||(i=I(e,"click",o),l=!0)},p(a,l){t=a,16&l&&c!==(c=t[13].name+"")&&T(n,c),1&l&&s!==(s="section "+(t[15]===t[0]&&"current")+" svelte-1ekbfpl")&&b(e,"class",s),t[15]===t[0]?u?u.p(t,l):(u=ce(t),u.c(),u.m(r.parentNode,r)):u&&(u.d(1),u=null)},d(t){t&&y(e),t&&y(a),u&&u.d(t),t&&y(r),l=!1,i()}}}function fe(t){let e,n,s,a,r,l,i,c,o=t[4],u=[];for(let f=0;f<o.length;f+=1)u[f]=ue(le(t,o,f));return r=new mt({props:{entries:t[5].entries}}),{c(){e=h("section"),n=h("div");for(let t=0;t<u.length;t+=1)u[t].c();s=p(),a=h("div"),k(r.$$.fragment),this.h()},l(t){e=$(t,"SECTION",{class:!0});var l=g(e);n=$(l,"DIV",{class:!0,style:!0});var i=g(n);for(let e=0;e<u.length;e+=1)u[e].l(i);i.forEach(y),s=E(l),a=$(l,"DIV",{class:!0});var c=g(a);N(r.$$.fragment,c),c.forEach(y),l.forEach(y),this.h()},h(){b(n,"class","sectionOverview svelte-1ekbfpl"),P(n,"margin-top",t[3]+"px"),b(a,"class","entries svelte-1ekbfpl"),b(e,"class","svelte-1ekbfpl")},m(o,f){w(o,e,f),x(e,n);for(let t=0;t<u.length;t+=1)u[t].m(n,null);t[11](n),x(e,s),x(e,a),D(r,a,null),t[12](e),l=!0,i||(c=I(e,"scroll",t[7]),i=!0)},p(t,[e]){if(81&e){let s;for(o=t[4],s=0;s<o.length;s+=1){const a=le(t,o,s);u[s]?u[s].p(a,e):(u[s]=ue(a),u[s].c(),u[s].m(n,null))}for(;s<u.length;s+=1)u[s].d(1);u.length=o.length}(!l||8&e)&&P(n,"margin-top",t[3]+"px");const s={};32&e&&(s.entries=t[5].entries),r.$set(s)},i(t){l||(O(r.$$.fragment,t),l=!0)},o(t){C(r.$$.fragment,t),l=!1},d(n){n&&y(e),S(u,n),t[11](null),A(r),t[12](null),i=!1,c()}}}function he(t,e,n){let s,a;var r,l,{adventure:i}=e,c=0,o=0;function u(t){let e=document.getElementById(t);e&&n(1,r.scrollTop=e.offsetTop,r)}return t.$$set=t=>{"adventure"in t&&n(8,i=t.adventure)},t.$$.update=()=>{256&t.$$.dirty&&n(4,s=function(t){return t.data,t.data.map((t=>{let e={name:t.name,subsections:[]};for(const n of t.entries)"object"==typeof n&&"entries"===n.type&&e.subsections.push({name:n.name,id:n.id});return e}))}(i)),257&t.$$.dirty&&n(5,a=i.data[c])},[c,r,l,o,s,a,u,function(){n(3,o=r.scrollTop)},i,t=>n(0,c=t),t=>u(t.id),function(t){V[t?"unshift":"push"]((()=>{n(2,l=t)}))},function(t){V[t?"unshift":"push"]((()=>{n(1,r=t)}))}]}class de extends o{constructor(t){super(),u(this,t,he,fe,f,{adventure:8})}}class pe extends o{constructor(t){super(),u(this,t,null,null,f,{})}}function me(t){let e,n,s;var a=t[1];function r(t){return{props:{data:t[0]}}}return a&&(e=new a(r(t))),{c(){e&&k(e.$$.fragment),n=m()},l(t){e&&N(e.$$.fragment,t),n=m()},m(t,a){e&&D(e,t,a),w(t,n,a),s=!0},p(t,[s]){const l={};if(1&s&&(l.data=t[0]),a!==(a=t[1])){if(e){z();const t=e;C(t.$$.fragment,1,0,(()=>{A(t,1)})),B()}a?(e=new a(r(t)),k(e.$$.fragment),O(e.$$.fragment,1),D(e,n.parentNode,n)):e=null}else a&&e.$set(l)},i(t){s||(e&&O(e.$$.fragment,t),s=!0)},o(t){e&&C(e.$$.fragment,t),s=!1},d(t){t&&y(n),e&&A(e,t)}}}function $e(t,e,n){let s,a;var{data:r}=e,{hash:l}=e;const i={background:jt,class:gt,item:vt,monster:yt,race:Ut,spell:Et,adventure:de,language:bt};return t.$$set=t=>{"data"in t&&n(2,r=t.data),"hash"in t&&n(3,l=t.hash)},t.$$.update=()=>{var e,c;12&t.$$.dirty&&n(0,(e=l,s=r||$t[e])),1&t.$$.dirty&&n(1,(c=s.dataType,a=i[c]||pe))},[s,a,r,l]}class ge extends o{constructor(t){super(),u(this,t,$e,me,f,{data:2,hash:3})}}function ve(t,e,n){const s=t.slice();return s[1]=e[n],s}function ye(t,e,n){const s=t.slice();return s[4]=e[n],s}function Ee(t,e,n){const s=t.slice();return s[7]=e[n],s}function be(t){let e,n,s;return{c(){e=h("img"),this.h()},l(t){e=$(t,"IMG",{src:!0,style:!0,alt:!0,class:!0}),this.h()},h(){e.src!==(n=t[7].src)&&b(e,"src",n),b(e,"style",s=t[7].transformStyle),b(e,"alt",""),b(e,"class","svelte-54hkii")},m(t,n){w(t,e,n)},p(t,a){1&a&&e.src!==(n=t[7].src)&&b(e,"src",n),1&a&&s!==(s=t[7].transformStyle)&&b(e,"style",s)},d(t){t&&y(e)}}}function we(t){let e,n,s,a;return n=new wt({props:{entry:t[4]}}),{c(){e=h("li"),k(n.$$.fragment),s=p()},l(t){e=$(t,"LI",{});var a=g(e);N(n.$$.fragment,a),s=E(a),a.forEach(y)},m(t,r){w(t,e,r),D(n,e,null),x(e,s),a=!0},p(t,e){const s={};1&e&&(s.entry=t[4]),n.$set(s)},i(t){a||(O(n.$$.fragment,t),a=!0)},o(t){C(n.$$.fragment,t),a=!1},d(t){t&&y(e),A(n)}}}function xe(t){let e,n,s,a;return n=new wt({props:{entry:t[1]}}),{c(){e=h("li"),k(n.$$.fragment),s=p()},l(t){e=$(t,"LI",{});var a=g(e);N(n.$$.fragment,a),s=E(a),a.forEach(y)},m(t,r){w(t,e,r),D(n,e,null),x(e,s),a=!0},p(t,e){const s={};1&e&&(s.entry=t[1]),n.$set(s)},i(t){a||(O(n.$$.fragment,t),a=!0)},o(t){C(n.$$.fragment,t),a=!1},d(t){t&&y(e),A(n)}}}function Ie(t){let e,n,s,a,r,l,i,c,o,u,f,m,I,k,N,P,D,A,V,H,R,q,M,j,U,L,F,X,_,W,G,Y,J,K,Q,Z,tt,et,nt,st,at,rt,lt,it,ct,ot,ut,ft,ht,dt,pt,mt,$t,gt,vt=t[0].fullName+"",yt=t[0].sex+"",Et=t[0].race+"",bt=t[0].voice+"",wt=t[0].voiceTrait+"",xt=t[0].age+"",It=t[0].stageOfLife+"",Tt=t[0].profession+"",St=t[0].imageLayers,kt=[];for(let h=0;h<St.length;h+=1)kt[h]=be(Ee(t,St,h));let Nt=t[0].traits,Pt=[];for(let h=0;h<Nt.length;h+=1)Pt[h]=we(ye(t,Nt,h));const Dt=t=>C(Pt[t],1,1,(()=>{Pt[t]=null}));let Ot=t[0].story,Ct=[];for(let h=0;h<Ot.length;h+=1)Ct[h]=xe(ve(t,Ot,h));const At=t=>C(Ct[t],1,1,(()=>{Ct[t]=null}));return{c(){e=h("section"),n=h("header"),s=h("div");for(let t=0;t<kt.length;t+=1)kt[t].c();a=p(),r=h("div"),l=h("h2"),i=d(vt),c=p(),o=h("h4"),u=d(yt),f=p(),m=d(Et),I=p(),k=h("div"),N=h("p"),P=h("b"),D=d("Voice"),A=d(": "),V=d(bt),H=p(),R=h("p"),q=h("b"),M=d("Trait"),j=d(": "),U=d(wt),L=p(),F=h("p"),X=h("b"),_=d("Age"),W=d(": "),G=d(xt),Y=d(" ("),J=d(It),K=d(")"),Q=p(),Z=h("p"),tt=h("b"),et=d("Profession"),nt=d(": "),st=d(Tt),at=p(),rt=h("div"),lt=h("div"),it=h("h6"),ct=d("Traits"),ot=p(),ut=h("ol");for(let t=0;t<Pt.length;t+=1)Pt[t].c();ft=p(),ht=h("div"),dt=h("h6"),pt=d("Story"),mt=p(),$t=h("ol");for(let t=0;t<Ct.length;t+=1)Ct[t].c();this.h()},l(t){e=$(t,"SECTION",{});var h=g(e);n=$(h,"HEADER",{class:!0});var d=g(n);s=$(d,"DIV",{class:!0});var p=g(s);for(let e=0;e<kt.length;e+=1)kt[e].l(p);p.forEach(y),a=E(d),r=$(d,"DIV",{class:!0});var b=g(r);l=$(b,"H2",{class:!0});var w=g(l);i=v(w,vt),w.forEach(y),c=E(b),o=$(b,"H4",{class:!0});var x=g(o);u=v(x,yt),f=E(x),m=v(x,Et),x.forEach(y),I=E(b),k=$(b,"DIV",{class:!0});var T=g(k);N=$(T,"P",{class:!0});var S=g(N);P=$(S,"B",{});var O=g(P);D=v(O,"Voice"),O.forEach(y),A=v(S,": "),V=v(S,bt),S.forEach(y),H=E(T),R=$(T,"P",{class:!0});var C=g(R);q=$(C,"B",{});var z=g(q);M=v(z,"Trait"),z.forEach(y),j=v(C,": "),U=v(C,wt),C.forEach(y),L=E(T),F=$(T,"P",{class:!0});var B=g(F);X=$(B,"B",{});var gt=g(X);_=v(gt,"Age"),gt.forEach(y),W=v(B,": "),G=v(B,xt),Y=v(B," ("),J=v(B,It),K=v(B,")"),B.forEach(y),Q=E(T),Z=$(T,"P",{class:!0});var St=g(Z);tt=$(St,"B",{});var Nt=g(tt);et=v(Nt,"Profession"),Nt.forEach(y),nt=v(St,": "),st=v(St,Tt),St.forEach(y),T.forEach(y),b.forEach(y),d.forEach(y),at=E(h),rt=$(h,"DIV",{class:!0});var Dt=g(rt);lt=$(Dt,"DIV",{class:!0});var Ot=g(lt);it=$(Ot,"H6",{class:!0});var At=g(it);ct=v(At,"Traits"),At.forEach(y),ot=E(Ot),ut=$(Ot,"OL",{});var Vt=g(ut);for(let e=0;e<Pt.length;e+=1)Pt[e].l(Vt);Vt.forEach(y),Ot.forEach(y),ft=E(Dt),ht=$(Dt,"DIV",{class:!0});var zt=g(ht);dt=$(zt,"H6",{class:!0});var Bt=g(dt);pt=v(Bt,"Story"),Bt.forEach(y),mt=E(zt),$t=$(zt,"OL",{});var Ht=g($t);for(let e=0;e<Ct.length;e+=1)Ct[e].l(Ht);Ht.forEach(y),zt.forEach(y),Dt.forEach(y),h.forEach(y),this.h()},h(){b(s,"class","imageWrapper svelte-54hkii"),b(l,"class","svelte-54hkii"),b(o,"class","svelte-54hkii"),b(N,"class","svelte-54hkii"),b(R,"class","svelte-54hkii"),b(F,"class","svelte-54hkii"),b(Z,"class","svelte-54hkii"),b(k,"class","details svelte-54hkii"),b(r,"class","generalWrapper svelte-54hkii"),b(n,"class","svelte-54hkii"),b(it,"class","svelte-54hkii"),b(lt,"class","svelte-54hkii"),b(dt,"class","svelte-54hkii"),b(ht,"class","svelte-54hkii"),b(rt,"class","content svelte-54hkii")},m(t,h){w(t,e,h),x(e,n),x(n,s);for(let e=0;e<kt.length;e+=1)kt[e].m(s,null);x(n,a),x(n,r),x(r,l),x(l,i),x(r,c),x(r,o),x(o,u),x(o,f),x(o,m),x(r,I),x(r,k),x(k,N),x(N,P),x(P,D),x(N,A),x(N,V),x(k,H),x(k,R),x(R,q),x(q,M),x(R,j),x(R,U),x(k,L),x(k,F),x(F,X),x(X,_),x(F,W),x(F,G),x(F,Y),x(F,J),x(F,K),x(k,Q),x(k,Z),x(Z,tt),x(tt,et),x(Z,nt),x(Z,st),x(e,at),x(e,rt),x(rt,lt),x(lt,it),x(it,ct),x(lt,ot),x(lt,ut);for(let e=0;e<Pt.length;e+=1)Pt[e].m(ut,null);x(rt,ft),x(rt,ht),x(ht,dt),x(dt,pt),x(ht,mt),x(ht,$t);for(let e=0;e<Ct.length;e+=1)Ct[e].m($t,null);gt=!0},p(t,[e]){if(1&e){let n;for(St=t[0].imageLayers,n=0;n<St.length;n+=1){const a=Ee(t,St,n);kt[n]?kt[n].p(a,e):(kt[n]=be(a),kt[n].c(),kt[n].m(s,null))}for(;n<kt.length;n+=1)kt[n].d(1);kt.length=St.length}if((!gt||1&e)&&vt!==(vt=t[0].fullName+"")&&T(i,vt),(!gt||1&e)&&yt!==(yt=t[0].sex+"")&&T(u,yt),(!gt||1&e)&&Et!==(Et=t[0].race+"")&&T(m,Et),(!gt||1&e)&&bt!==(bt=t[0].voice+"")&&T(V,bt),(!gt||1&e)&&wt!==(wt=t[0].voiceTrait+"")&&T(U,wt),(!gt||1&e)&&xt!==(xt=t[0].age+"")&&T(G,xt),(!gt||1&e)&&It!==(It=t[0].stageOfLife+"")&&T(J,It),(!gt||1&e)&&Tt!==(Tt=t[0].profession+"")&&T(st,Tt),1&e){let n;for(Nt=t[0].traits,n=0;n<Nt.length;n+=1){const s=ye(t,Nt,n);Pt[n]?(Pt[n].p(s,e),O(Pt[n],1)):(Pt[n]=we(s),Pt[n].c(),O(Pt[n],1),Pt[n].m(ut,null))}for(z(),n=Nt.length;n<Pt.length;n+=1)Dt(n);B()}if(1&e){let n;for(Ot=t[0].story,n=0;n<Ot.length;n+=1){const s=ve(t,Ot,n);Ct[n]?(Ct[n].p(s,e),O(Ct[n],1)):(Ct[n]=xe(s),Ct[n].c(),O(Ct[n],1),Ct[n].m($t,null))}for(z(),n=Ot.length;n<Ct.length;n+=1)At(n);B()}},i(t){if(!gt){for(let t=0;t<Nt.length;t+=1)O(Pt[t]);for(let t=0;t<Ot.length;t+=1)O(Ct[t]);gt=!0}},o(t){Pt=Pt.filter(Boolean);for(let e=0;e<Pt.length;e+=1)C(Pt[e]);Ct=Ct.filter(Boolean);for(let e=0;e<Ct.length;e+=1)C(Ct[e]);gt=!1},d(t){t&&y(e),S(kt,t),S(Pt,t),S(Ct,t)}}}function Te(t,e,n){let{data:s}=e;return t.$$set=t=>{"data"in t&&n(0,s=t.data)},[s]}class Se extends o{constructor(t){super(),u(this,t,Te,Ie,f,{data:0})}}function ke(t){let e,n,s,a,r,l;return{c(){e=h("div"),n=h("input"),s=p(),a=h("textarea"),this.h()},l(t){e=$(t,"DIV",{class:!0});var r=g(e);n=$(r,"INPUT",{type:!0,class:!0}),s=E(r),a=$(r,"TEXTAREA",{placeholder:!0,class:!0}),g(a).forEach(y),r.forEach(y),this.h()},h(){b(n,"type","text"),b(n,"class","svelte-1nxkfg0"),b(a,"placeholder","Write a note"),b(a,"class","svelte-1nxkfg0"),b(e,"class","note svelte-1nxkfg0")},m(i,c){w(i,e,c),x(e,n),H(n,t[1].title),x(e,s),x(e,a),H(a,t[0].content),r||(l=[I(n,"input",t[4]),I(n,"blur",t[2]),I(a,"input",t[5]),I(a,"blur",t[2])],r=!0)},p(t,[e]){2&e&&n.value!==t[1].title&&H(n,t[1].title),1&e&&H(a,t[0].content)},i:R,o:R,d(t){t&&y(e),r=!1,q(l)}}}function Ne(t,e,n){let{data:s}=e;var{item:a=M("screenItem")}=e,{campaign:r=M("campaign")}=e;return t.$$set=t=>{"data"in t&&n(0,s=t.data),"item"in t&&n(1,a=t.item),"campaign"in t&&n(3,r=t.campaign)},[s,a,function(){r&&r.refresh()},r,function(){a.title=this.value,n(1,a)},function(){s.content=this.value,n(0,s)}]}class Pe extends o{constructor(t){super(),u(this,t,Ne,ke,f,{data:0,item:1,campaign:3})}}function De(t={}){return c(i({name:"New encounter",monsters:[]},t),{getMonsters(){return this.monsters.map((t=>xt[t]))},getTotalXP(){return this.getMonsters().reduce(((t,e)=>t+e.getXPValue()),0)},getEncounterXP(){let t=this.getTotalXP(),e=1,n=this.monsters.length;return n>=2?e=1.5:n>=3?e=2:n>=7?e=2.5:n>=11?e=3:n>=15&&(e=4),t*e},getEncounterDifficulty(t){let e=this.getEncounterXP(),n="super easy";for(let[s,a]of Object.entries(t))e>=a&&(n=s);return n},addMonster(t){"object"==typeof t&&(t=t.hash),this.monsters.push(t)},removeMonster(t){"object"==typeof t&&(t=t.hash);let e=this.monsters.indexOf(t);-1!==e&&this.monsters.splice(e,1)}})}function Oe(t){let e,n,s,a,r;function l(e){t[14](e)}e=new It({props:{headers:t[4],items:t[0],clickable:t[1],tiny:t[2],limit:t[3]}}),e.$on("click",t[7]);let i={entry:t[5]};return void 0!==t[6]&&(i.open=t[6]),s=new Tt({props:i}),V.push((()=>j(s,"open",l))),{c(){k(e.$$.fragment),n=p(),k(s.$$.fragment)},l(t){N(e.$$.fragment,t),n=E(t),N(s.$$.fragment,t)},m(t,a){D(e,t,a),w(t,n,a),D(s,t,a),r=!0},p(t,[n]){const r={};16&n&&(r.headers=t[4]),1&n&&(r.items=t[0]),2&n&&(r.clickable=t[1]),4&n&&(r.tiny=t[2]),8&n&&(r.limit=t[3]),e.$set(r);const l={};32&n&&(l.entry=t[5]),!a&&64&n&&(a=!0,l.open=t[6],U((()=>a=!1))),s.$set(l)},i(t){r||(O(e.$$.fragment,t),O(s.$$.fragment,t),r=!0)},o(t){C(e.$$.fragment,t),C(s.$$.fragment,t),r=!1},d(t){A(e,t),t&&y(n),A(s,t)}}}function Ce(t,e,n){const s=L();var a,{encounter:r=null}=e,{items:l}=e,{alignment:i=!1}=e,{cr:c=!1}=e,{environments:o=!1}=e,{popup:u=!1}=e,{hidePopupIndicator:f=!1}=e,{remove:h=!1}=e,{tiny:d=!1}=e,{limit:p=null}=e,m=!1,$=[];const g={unaligned:{color:"#ffffff",backgroundColor:"#814e4e"},"lawful evil":{color:"#ffffff",backgroundColor:"#850707"},"neutral evil":{color:"#ffffff",backgroundColor:"#c3510e"},"chaotic evil":{color:"#ffffff",backgroundColor:"#ff0000"},"lawful neutral":{color:"#ffffff",backgroundColor:"#17cdab"},"lawful good":{color:"#ffffff",backgroundColor:"#00cb35"},"chaotic good":{color:"#ffffff",backgroundColor:"#0e7c30"}};return t.$$set=t=>{"encounter"in t&&n(8,r=t.encounter),"items"in t&&n(0,l=t.items),"alignment"in t&&n(9,i=t.alignment),"cr"in t&&n(10,c=t.cr),"environments"in t&&n(11,o=t.environments),"popup"in t&&n(1,u=t.popup),"hidePopupIndicator"in t&&n(12,f=t.hidePopupIndicator),"remove"in t&&n(13,h=t.remove),"tiny"in t&&n(2,d=t.tiny),"limit"in t&&n(3,p=t.limit)},t.$$.update=()=>{16146&t.$$.dirty&&(n(4,$=[]),$.push({header:"Monster",type:St.SUBTEXT,alignment:kt.LEFT,sortable:!0,wide:!0,text:t=>t.name,subtext:t=>t.getDescription(),sort:(t,e)=>t.name<e.name?1:-1}),c&&$.push({header:"CR",type:St.TEXT,sortable:!0,text:t=>t.getCRStringWithoutXP(),sort:(t,e)=>t.getCRValue()-e.getCRValue()}),i&&$.push({header:"Aligmnent",type:St.TEXT,text:()=>"",textDecorations:t=>{let e="#ffffff",n="#7a7a7a",s=t.getAlignmentString();if(s in g){let t=g[s];e=t.color,n=t.backgroundColor}return[{color:e,backgroundColor:n,text:s}]}}),o&&$.push({header:"Environments",type:St.TEXT,alignment:kt.CENTER,maxWidth:150,text:t=>t.environment?t.environment.map(Nt).join(", "):"—"}),r&&$.push({type:St.BUTTON,text:()=>"Add to encounter",onClick:t=>{r.addMonster(t),n(8,r),n(4,$),n(10,c),n(9,i),n(11,o),n(1,u),n(12,f),n(13,h)}}),u&&!f&&$.push({type:St.ICON_BUTTON,icon:()=>"arrow-expand-all"}),h&&$.push({type:St.ICON_BUTTON,icon:()=>"close",onClick:t=>s("remove",t)}))},[l,u,d,p,$,a,m,function({detail:t}){u&&(n(5,a=t),n(6,m=!0))},r,i,c,o,f,h,function(t){n(6,m=t)}]}class Ae extends o{constructor(t){super(),u(this,t,Ce,Oe,f,{encounter:8,items:0,alignment:9,cr:10,environments:11,popup:1,hidePopupIndicator:12,remove:13,tiny:2,limit:3})}}function Ve(t){let e;return{c(){e=d("Add to initiative")},l(t){e=v(t,"Add to initiative")},m(t,n){w(t,e,n)},d(t){t&&y(e)}}}function ze(t){let e,n,s,a,r,l,i,c,o,u,f,m,I,S,P,V,z,B,H,R,q,M,j,U,L,F;return j=new Pt({props:{$$slots:{default:[Ve]},$$scope:{ctx:t}}}),j.$on("click",t[5]),L=new Ae({props:{items:t[2],popup:!0}}),{c(){e=h("div"),n=h("header"),s=h("h1"),a=d(t[1]),l=p(),i=h("div"),c=h("section"),o=h("h4"),u=d(t[3]),f=p(),m=h("h6"),I=d("XP Reward"),S=p(),P=h("section"),V=h("h4"),z=d(t[4]),B=p(),H=h("h6"),R=d("Adjusted XP"),q=p(),M=h("div"),k(j.$$.fragment),U=p(),k(L.$$.fragment),this.h()},l(r){e=$(r,"DIV",{class:!0});var h=g(e);n=$(h,"HEADER",{class:!0});var d=g(n);s=$(d,"H1",{class:!0});var p=g(s);a=v(p,t[1]),p.forEach(y),l=E(d),i=$(d,"DIV",{class:!0});var b=g(i);c=$(b,"SECTION",{});var w=g(c);o=$(w,"H4",{class:!0});var x=g(o);u=v(x,t[3]),x.forEach(y),f=E(w),m=$(w,"H6",{class:!0});var T=g(m);I=v(T,"XP Reward"),T.forEach(y),w.forEach(y),S=E(b),P=$(b,"SECTION",{});var k=g(P);V=$(k,"H4",{class:!0});var D=g(V);z=v(D,t[4]),D.forEach(y),B=E(k),H=$(k,"H6",{class:!0});var O=g(H);R=v(O,"Adjusted XP"),O.forEach(y),k.forEach(y),b.forEach(y),q=E(d),M=$(d,"DIV",{class:!0});var C=g(M);N(j.$$.fragment,C),C.forEach(y),d.forEach(y),U=E(h),N(L.$$.fragment,h),h.forEach(y),this.h()},h(){b(s,"class",r="difficulty "+t[1]+" svelte-gp5lg1"),b(o,"class","xp svelte-gp5lg1"),b(m,"class","svelte-gp5lg1"),b(V,"class","xp svelte-gp5lg1"),b(H,"class","svelte-gp5lg1"),b(i,"class","svelte-gp5lg1"),b(M,"class","svelte-gp5lg1"),b(n,"class","svelte-gp5lg1"),b(e,"class","encounter")},m(t,r){w(t,e,r),x(e,n),x(n,s),x(s,a),x(n,l),x(n,i),x(i,c),x(c,o),x(o,u),x(c,f),x(c,m),x(m,I),x(i,S),x(i,P),x(P,V),x(V,z),x(P,B),x(P,H),x(H,R),x(n,q),x(n,M),D(j,M,null),x(e,U),D(L,e,null),F=!0},p(t,[e]){(!F||2&e)&&T(a,t[1]),(!F||2&e&&r!==(r="difficulty "+t[1]+" svelte-gp5lg1"))&&b(s,"class",r),(!F||8&e)&&T(u,t[3]),(!F||16&e)&&T(z,t[4]);const n={};1024&e&&(n.$$scope={dirty:e,ctx:t}),j.$set(n);const l={};4&e&&(l.items=t[2]),L.$set(l)},i(t){F||(O(j.$$.fragment,t),O(L.$$.fragment,t),F=!0)},o(t){C(j.$$.fragment,t),C(L.$$.fragment,t),F=!1},d(t){t&&y(e),A(j),A(L)}}}function Be(t,e,n){let s,a,r,l,i,c,o,u=R,f=()=>(u(),u=F(d,(t=>n(9,o=t))),d);t.$$.on_destroy.push((()=>u()));var{data:h}=e,{campaign:d=M("campaign")}=e;return f(),t.$$set=t=>{"data"in t&&n(6,h=t.data),"campaign"in t&&f(n(0,d=t.campaign))},t.$$.update=()=>{64&t.$$.dirty&&n(7,s=De(h)),512&t.$$.dirty&&n(8,a=o.party.getXPThreshHolds()),384&t.$$.dirty&&n(1,r=s.getEncounterDifficulty(a)),128&t.$$.dirty&&n(2,l=s.getMonsters()),128&t.$$.dirty&&n(3,i=s.getTotalXP()),128&t.$$.dirty&&n(4,c=s.getEncounterXP())},[d,r,l,i,c,function(){l.forEach((t=>o.initiative.addMonster(t)))},h,s,a,o]}class He extends o{constructor(t){super(),u(this,t,Be,ze,f,{data:6,campaign:0})}}function Re(t){let e,n,s;var a=t[1];function r(t){return{props:{data:t[2],item:t[0]}}}return a&&(e=new a(r(t))),{c(){e&&k(e.$$.fragment),n=m()},l(t){e&&N(e.$$.fragment,t),n=m()},m(t,a){e&&D(e,t,a),w(t,n,a),s=!0},p(t,[s]){const l={};if(4&s&&(l.data=t[2]),1&s&&(l.item=t[0]),a!==(a=t[1])){if(e){z();const t=e;C(t.$$.fragment,1,0,(()=>{A(t,1)})),B()}a?(e=new a(r(t)),k(e.$$.fragment),O(e.$$.fragment,1),D(e,n.parentNode,n)):e=null}else a&&e.$set(l)},i(t){s||(e&&O(e.$$.fragment,t),s=!0)},o(t){e&&C(e.$$.fragment,t),s=!1},d(t){t&&y(n),e&&A(e,t)}}}function qe(t,e,n){let s,a;var{item:r}=e;const l={hashRef:ge,npc:Se,note:Pe,encounter:He};return t.$$set=t=>{"item"in t&&n(0,r=t.item)},t.$$.update=()=>{var e;1&t.$$.dirty&&n(1,(e=r.type,s=l[e])),1&t.$$.dirty&&n(2,a=function(t,e){return t===Kt.HASH_REF?$t[e]:e}(r.type,r.data))},[r,s,a]}class Me extends o{constructor(t){super(),u(this,t,qe,Re,f,{item:0})}}function je(t){let e,n,s;e=new Ot({props:{text:t[1].fullName,background:"./img/header/tree.jpg"}});const a=t[2].default,r=X(a,t,t[4],null),l=r||function(t){let e,n;return e=new Se({props:{data:t[1]}}),{c(){k(e.$$.fragment)},l(t){N(e.$$.fragment,t)},m(t,s){D(e,t,s),n=!0},p(t,n){const s={};2&n&&(s.data=t[1]),e.$set(s)},i(t){n||(O(e.$$.fragment,t),n=!0)},o(t){C(e.$$.fragment,t),n=!1},d(t){A(e,t)}}}(t);return{c(){k(e.$$.fragment),n=p(),l&&l.c()},l(t){N(e.$$.fragment,t),n=E(t),l&&l.l(t)},m(t,a){D(e,t,a),w(t,n,a),l&&l.m(t,a),s=!0},p(t,n){const i={};2&n&&(i.text=t[1].fullName),e.$set(i),r?r.p&&(!s||16&n)&&_(r,a,t,t[4],n,null,null):l&&l.p&&2&n&&l.p(t,n)},i(t){s||(O(e.$$.fragment,t),O(l,t),s=!0)},o(t){C(e.$$.fragment,t),C(l,t),s=!1},d(t){A(e,t),t&&y(n),l&&l.d(t)}}}function Ue(t){let e,n,s;function a(e){t[3](e)}let r={$$slots:{default:[je]},$$scope:{ctx:t}};return void 0!==t[0]&&(r.open=t[0]),e=new Dt({props:r}),V.push((()=>j(e,"open",a))),{c(){k(e.$$.fragment)},l(t){N(e.$$.fragment,t)},m(t,n){D(e,t,n),s=!0},p(t,[s]){const a={};18&s&&(a.$$scope={dirty:s,ctx:t}),!n&&1&s&&(n=!0,a.open=t[0],U((()=>n=!1))),e.$set(a)},i(t){s||(O(e.$$.fragment,t),s=!0)},o(t){C(e.$$.fragment,t),s=!1},d(t){A(e,t)}}}function Le(t,e,n){let{$$slots:s={},$$scope:a}=e;var{open:r=!1}=e,{entry:l}=e;return t.$$set=t=>{"open"in t&&n(0,r=t.open),"entry"in t&&n(1,l=t.entry),"$$scope"in t&&n(4,a=t.$$scope)},[r,l,s,function(t){n(0,r=t)},a]}class Fe extends o{constructor(t){super(),u(this,t,Le,Ue,f,{open:0,entry:1})}}function Xe(t){let e,n,s;e=new Ot({props:{text:t[1].title,background:"./img/header/planet.jpg"}});const a=t[2].default,r=X(a,t,t[4],null),l=r||function(t){let e,n;return e=new Pe({props:{data:t[1]}}),{c(){k(e.$$.fragment)},l(t){N(e.$$.fragment,t)},m(t,s){D(e,t,s),n=!0},p(t,n){const s={};2&n&&(s.data=t[1]),e.$set(s)},i(t){n||(O(e.$$.fragment,t),n=!0)},o(t){C(e.$$.fragment,t),n=!1},d(t){A(e,t)}}}(t);return{c(){k(e.$$.fragment),n=p(),l&&l.c()},l(t){N(e.$$.fragment,t),n=E(t),l&&l.l(t)},m(t,a){D(e,t,a),w(t,n,a),l&&l.m(t,a),s=!0},p(t,n){const i={};2&n&&(i.text=t[1].title),e.$set(i),r?r.p&&(!s||16&n)&&_(r,a,t,t[4],n,null,null):l&&l.p&&2&n&&l.p(t,n)},i(t){s||(O(e.$$.fragment,t),O(l,t),s=!0)},o(t){C(e.$$.fragment,t),C(l,t),s=!1},d(t){A(e,t),t&&y(n),l&&l.d(t)}}}function _e(t){let e,n,s;function a(e){t[3](e)}let r={$$slots:{default:[Xe]},$$scope:{ctx:t}};return void 0!==t[0]&&(r.open=t[0]),e=new Dt({props:r}),V.push((()=>j(e,"open",a))),{c(){k(e.$$.fragment)},l(t){N(e.$$.fragment,t)},m(t,n){D(e,t,n),s=!0},p(t,[s]){const a={};18&s&&(a.$$scope={dirty:s,ctx:t}),!n&&1&s&&(n=!0,a.open=t[0],U((()=>n=!1))),e.$set(a)},i(t){s||(O(e.$$.fragment,t),s=!0)},o(t){C(e.$$.fragment,t),s=!1},d(t){A(e,t)}}}function We(t,e,n){let{$$slots:s={},$$scope:a}=e;var{open:r=!1}=e,{entry:l}=e;return t.$$set=t=>{"open"in t&&n(0,r=t.open),"entry"in t&&n(1,l=t.entry),"$$scope"in t&&n(4,a=t.$$scope)},[r,l,s,function(t){n(0,r=t)},a]}class Ge extends o{constructor(t){super(),u(this,t,We,_e,f,{open:0,entry:1})}}function Ye(t){let e,n,s,a;function r(e){t[4](e)}var l=t[1];function i(t){let e={entry:t[2]};return void 0!==t[0]&&(e.open=t[0]),{props:e}}return l&&(e=new l(i(t)),V.push((()=>j(e,"open",r)))),{c(){e&&k(e.$$.fragment),s=m()},l(t){e&&N(e.$$.fragment,t),s=m()},m(t,n){e&&D(e,t,n),w(t,s,n),a=!0},p(t,[a]){const c={};if(4&a&&(c.entry=t[2]),!n&&1&a&&(n=!0,c.open=t[0],U((()=>n=!1))),l!==(l=t[1])){if(e){z();const t=e;C(t.$$.fragment,1,0,(()=>{A(t,1)})),B()}l?(e=new l(i(t)),V.push((()=>j(e,"open",r))),k(e.$$.fragment),O(e.$$.fragment,1),D(e,s.parentNode,s)):e=null}else l&&e.$set(c)},i(t){a||(e&&O(e.$$.fragment,t),a=!0)},o(t){e&&C(e.$$.fragment,t),a=!1},d(t){t&&y(s),e&&A(e,t)}}}function Je(t,e,n){let s,a;var{entry:r}=e,{open:l=!1}=e;const i={hashRef:Ct,npc:Fe,note:Ge};return t.$$set=t=>{"entry"in t&&n(3,r=t.entry),"open"in t&&n(0,l=t.open)},t.$$.update=()=>{var e;8&t.$$.dirty&&n(1,(e=r.type,s=i[e])),8&t.$$.dirty&&n(2,a=function(t,e){return"hashRef"===t?$t[e]:e}(r.type,r.data))},[l,s,a,r,function(t){n(0,l=t)}]}class Ke extends o{constructor(t){super(),u(this,t,Je,Ye,f,{entry:3,open:0})}}function Qe(){return{start(){document.addEventListener("mousemove",this.onChange)},stop(){document.removeEventListener("mousemove",this.onChange)},onChange:t=>{}}}const Ze=t=>({open:64&t[0]}),tn=t=>({open:t[6]});function en(t,e,n){const s=t.slice();return s[3]=e[n],s}function nn(t){let e,n,s,a=t[3].name+"";return{c(){e=h("option"),n=d(a),this.h()},l(t){e=$(t,"OPTION",{value:!0});var s=g(e);n=v(s,a),s.forEach(y),this.h()},h(){e.__value=s=t[3].id,e.value=e.__value},m(t,s){w(t,e,s),x(e,n)},p(t,r){4096&r[0]&&a!==(a=t[3].name+"")&&T(n,a),4096&r[0]&&s!==(s=t[3].id)&&(e.__value=s,e.value=e.__value)},d(t){t&&y(e)}}}function sn(t){let e,n,s,a,r,l,i,c,o,u,f,d,m,v,x,T,S;return{c(){e=h("div"),n=p(),s=h("div"),a=p(),r=h("div"),l=p(),i=h("div"),c=p(),o=h("div"),u=p(),f=h("div"),d=p(),m=h("div"),v=p(),x=h("div"),this.h()},l(t){e=$(t,"DIV",{class:!0}),g(e).forEach(y),n=E(t),s=$(t,"DIV",{class:!0}),g(s).forEach(y),a=E(t),r=$(t,"DIV",{class:!0}),g(r).forEach(y),l=E(t),i=$(t,"DIV",{class:!0}),g(i).forEach(y),c=E(t),o=$(t,"DIV",{class:!0}),g(o).forEach(y),u=E(t),f=$(t,"DIV",{class:!0}),g(f).forEach(y),d=E(t),m=$(t,"DIV",{class:!0}),g(m).forEach(y),v=E(t),x=$(t,"DIV",{class:!0}),g(x).forEach(y),this.h()},h(){b(e,"class","leftHold svelte-bz66p5"),b(s,"class","rightHold svelte-bz66p5"),b(r,"class","topHold svelte-bz66p5"),b(i,"class","bottomHold svelte-bz66p5"),b(o,"class","topLeftHold svelte-bz66p5"),b(f,"class","topRightHold svelte-bz66p5"),b(m,"class","bottomLeftHold svelte-bz66p5"),b(x,"class","bottomRightHold svelte-bz66p5")},m(h,p){w(h,e,p),w(h,n,p),w(h,s,p),w(h,a,p),w(h,r,p),w(h,l,p),w(h,i,p),w(h,c,p),w(h,o,p),w(h,u,p),w(h,f,p),w(h,d,p),w(h,m,p),w(h,v,p),w(h,x,p),T||(S=[I(e,"mousedown",t[27]),I(s,"mousedown",t[28]),I(r,"mousedown",t[29]),I(i,"mousedown",t[30]),I(o,"mousedown",t[19]),I(f,"mousedown",t[20]),I(m,"mousedown",t[21]),I(x,"mousedown",t[22])],T=!0)},p:R,d(t){t&&y(e),t&&y(n),t&&y(s),t&&y(a),t&&y(r),t&&y(l),t&&y(i),t&&y(c),t&&y(o),t&&y(u),t&&y(f),t&&y(d),t&&y(m),t&&y(v),t&&y(x),T=!1,q(S)}}}function an(t){let e;const n=t[25].popup,s=X(n,t,t[33],tn);return{c(){s&&s.c()},l(t){s&&s.l(t)},m(t,n){s&&s.m(t,n),e=!0},p(t,a){s&&s.p&&(!e||64&a[0]|4&a[1])&&_(s,n,t,t[33],a,Ze,tn)},i(t){e||(O(s,t),e=!0)},o(t){C(s,t),e=!1},d(t){s&&s.d(t)}}}function rn(t){let e,n,s;function a(e){t[32](e)}let r={$$slots:{default:[ln]},$$scope:{ctx:t}};return void 0!==t[6]&&(r.open=t[6]),e=new Dt({props:r}),V.push((()=>j(e,"open",a))),{c(){k(e.$$.fragment)},l(t){N(e.$$.fragment,t)},m(t,n){D(e,t,n),s=!0},p(t,s){const a={};4&s[1]&&(a.$$scope={dirty:s,ctx:t}),!n&&64&s[0]&&(n=!0,a.open=t[6],U((()=>n=!1))),e.$set(a)},i(t){s||(O(e.$$.fragment,t),s=!0)},o(t){C(e.$$.fragment,t),s=!1},d(t){A(e,t)}}}function ln(t){let e;const n=t[25].default,s=X(n,t,t[33],null);return{c(){s&&s.c()},l(t){s&&s.l(t)},m(t,n){s&&s.m(t,n),e=!0},p(t,a){s&&s.p&&(!e||4&a[1])&&_(s,n,t,t[33],a,null,null)},i(t){e||(O(s,t),e=!0)},o(t){C(s,t),e=!1},d(t){s&&s.d(t)}}}function cn(t){let e,n,s,a,r,l,i,c,o,u,f,m,k,N,P,D,A,V,H,R,M,j,U,L,F,Y;const J=t[25].default,K=X(J,t,t[33],null);let Q=t[12],Z=[];for(let h=0;h<Q.length;h+=1)Z[h]=nn(en(t,Q,h));let tt=!t[0].pinned&&sn(t);const et=[rn,an],nt=[];function st(t,e){return void 0===t[23].popup?0:1}return M=st(t),j=nt[M]=et[M](t),{c(){e=h("section"),n=h("div"),K&&K.c(),s=p(),a=h("div"),r=h("button"),l=h("span"),i=p(),c=h("button"),o=h("span"),f=p(),m=h("button"),k=h("span"),N=p(),P=h("span"),D=d(t[1]),A=p(),V=h("select");for(let t=0;t<Z.length;t+=1)Z[t].c();H=p(),tt&&tt.c(),R=p(),j.c(),U=p(),this.h()},l(u){e=$(u,"SECTION",{class:!0,style:!0});var h=g(e);n=$(h,"DIV",{class:!0});var d=g(n);K&&K.l(d),d.forEach(y),s=E(h),a=$(h,"DIV",{class:!0});var p=g(a);r=$(p,"BUTTON",{class:!0});var b=g(r);l=$(b,"SPAN",{class:!0}),g(l).forEach(y),b.forEach(y),i=E(p),c=$(p,"BUTTON",{class:!0});var w=g(c);o=$(w,"SPAN",{class:!0}),g(o).forEach(y),w.forEach(y),f=E(p),m=$(p,"BUTTON",{class:!0});var x=g(m);k=$(x,"SPAN",{class:!0}),g(k).forEach(y),x.forEach(y),N=E(p),P=$(p,"SPAN",{class:!0});var I=g(P);D=v(I,t[1]),I.forEach(y),A=E(p),V=$(p,"SELECT",{class:!0});var T=g(V);for(let t=0;t<Z.length;t+=1)Z[t].l(T);T.forEach(y),p.forEach(y),H=E(h),tt&&tt.l(h),h.forEach(y),R=E(u),j.l(u),U=E(u),this.h()},h(){b(n,"class","display svelte-bz66p5"),b(l,"class","mdi mdi-arrow-expand-all"),b(r,"class","svelte-bz66p5"),b(o,"class",u="mdi mdi-"+(t[0].pinned?"pin-off":"pin-outline")),b(c,"class","svelte-bz66p5"),b(k,"class","mdi mdi-delete-outline"),b(m,"class","svelte-bz66p5"),b(P,"class","svelte-bz66p5"),b(V,"class","svelte-bz66p5"),void 0===t[5]&&W((()=>t[26].call(V))),b(a,"class","controlls svelte-bz66p5"),b(e,"class","item svelte-bz66p5"),b(e,"style",t[11])},m(u,h){w(u,e,h),x(e,n),K&&K.m(n,null),x(e,s),x(e,a),x(a,r),x(r,l),x(a,i),x(a,c),x(c,o),x(a,f),x(a,m),x(m,k),x(a,N),x(a,P),x(P,D),x(a,A),x(a,V);for(let t=0;t<Z.length;t+=1)Z[t].m(V,null);G(V,t[5]),x(e,H),tt&&tt.m(e,null),t[31](e),w(u,R,h),nt[M].m(u,h),w(u,U,h),L=!0,F||(Y=[I(n,"mousedown",t[17]),I(r,"click",t[15]),I(c,"click",t[14]),I(m,"click",t[16]),I(V,"change",t[26]),I(V,"change",t[13]),I(document.body,"mouseup",t[18])],F=!0)},p(t,n){if(K&&K.p&&(!L||4&n[1])&&_(K,J,t,t[33],n,null,null),(!L||1&n[0]&&u!==(u="mdi mdi-"+(t[0].pinned?"pin-off":"pin-outline")))&&b(o,"class",u),(!L||2&n[0])&&T(D,t[1]),4096&n[0]){let e;for(Q=t[12],e=0;e<Q.length;e+=1){const s=en(t,Q,e);Z[e]?Z[e].p(s,n):(Z[e]=nn(s),Z[e].c(),Z[e].m(V,null))}for(;e<Z.length;e+=1)Z[e].d(1);Z.length=Q.length}4128&n[0]&&G(V,t[5]),t[0].pinned?tt&&(tt.d(1),tt=null):tt?tt.p(t,n):(tt=sn(t),tt.c(),tt.m(e,null)),(!L||2048&n[0])&&b(e,"style",t[11]);let s=M;M=st(t),M===s?nt[M].p(t,n):(z(),C(nt[s],1,1,(()=>{nt[s]=null})),B(),j=nt[M],j?j.p(t,n):(j=nt[M]=et[M](t),j.c()),O(j,1),j.m(U.parentNode,U))},i(t){L||(O(K,t),O(j),L=!0)},o(t){C(K,t),C(j),L=!1},d(n){n&&y(e),K&&K.d(n),S(Z,n),tt&&tt.d(),t[31](null),n&&y(R),nt[M].d(n),n&&y(U),F=!1,q(Y)}}}function on(t,e,n){let s,a,r,l,i=R,c=()=>(i(),i=F($,(t=>n(24,l=t))),$);t.$$.on_destroy.push((()=>i()));let{$$slots:o={},$$scope:u}=e;const f=Y(o);var h,{label:d}=e,{item:p}=e,{screen:m=M("dmScreen")}=e,{campaign:$=M("campaign")}=e;c();var g=m.id,v=!1,y=Qe(),E=Qe(),b=Qe(),w=Qe(),x=Qe();x.onChange=t=>{if(!p.pinned){t.preventDefault();let{movementX:e,movementY:s}=t;n(0,p.left+=e,p),n(0,p.top+=s,p)}},y.onChange=t=>{t.preventDefault();let{movementX:e}=t;p.width+e<100?n(0,p.width=100,p):n(0,p.width+=e,p)},E.onChange=t=>{t.preventDefault();let{movementX:e}=t;p.width-e<100?n(0,p.width=100,p):(n(0,p.width-=e,p),n(0,p.left+=e,p))},b.onChange=t=>{t.preventDefault();let{movementY:e}=t;p.height-e<100?n(0,p.height=100,p):(n(0,p.height-=e,p),n(0,p.top+=e,p))},w.onChange=t=>{t.preventDefault();let{movementY:e}=t;p.height+e<100?n(0,p.height=100,p):n(0,p.height+=e,p)};return t.$$set=t=>{"label"in t&&n(1,d=t.label),"item"in t&&n(0,p=t.item),"screen"in t&&n(3,m=t.screen),"campaign"in t&&c(n(2,$=t.campaign)),"$$scope"in t&&n(33,u=t.$$scope)},t.$$.update=()=>{4&t.$$.dirty[0]&&(s=$.campaignStore),1&t.$$.dirty[0]&&n(11,a=function({top:t,left:e,height:n,width:s,index:a}){return`top: ${t}px; left: ${e}px; height: ${n}px; width: ${s}px; z-index: ${a};`}(p)),16777216&t.$$.dirty[0]&&n(12,r=l.screens.get())},[p,d,$,m,h,g,v,y,E,b,w,a,r,function(){$.screens.moveItemTo(p,g)},function(){$.screens.togglePin(p),n(0,p)},function(){n(6,v=!0)},function(){$.screens.removeItemFromScreen(m,p)},function(){$.screens.moveUp(p),x.start()},function(){y.stop(),E.stop(),b.stop(),w.stop(),x.stop(),s.refresh()},function(){b.start(),E.start()},function(){b.start(),y.start()},function(){w.start(),E.start()},function(){w.start(),y.start()},f,l,o,function(){g=J(this),n(5,g),n(12,r),n(24,l)},()=>E.start(),()=>y.start(),()=>b.start(),()=>w.start(),function(t){V[t?"unshift":"push"]((()=>{n(4,h=t)}))},function(t){n(6,v=t)},u]}class un extends o{constructor(t){super(),u(this,t,on,cn,f,{label:1,item:0,screen:3,campaign:2},[-1,-1])}}function fn(t){let e,n;return e=new Me({props:{item:t[1]}}),{c(){k(e.$$.fragment)},l(t){N(e.$$.fragment,t)},m(t,s){D(e,t,s),n=!0},p(t,n){const s={};2&n&&(s.item=t[1]),e.$set(s)},i(t){n||(O(e.$$.fragment,t),n=!0)},o(t){C(e.$$.fragment,t),n=!1},d(t){A(e,t)}}}function hn(t){let e,n;return e=new Ke({props:{slot:"popup",entry:t[1],open:t[4]}}),{c(){k(e.$$.fragment)},l(t){N(e.$$.fragment,t)},m(t,s){D(e,t,s),n=!0},p(t,n){const s={};2&n&&(s.entry=t[1]),16&n&&(s.open=t[4]),e.$set(s)},i(t){n||(O(e.$$.fragment,t),n=!0)},o(t){C(e.$$.fragment,t),n=!1},d(t){A(e,t)}}}function dn(t){let e,n;return e=new un({props:{label:t[2],screen:t[0],item:t[1],$$slots:{popup:[hn,({open:t})=>({4:t}),({open:t})=>t?16:0],default:[fn,({open:t})=>({4:t}),({open:t})=>t?16:0]},$$scope:{ctx:t}}}),{c(){k(e.$$.fragment)},l(t){N(e.$$.fragment,t)},m(t,s){D(e,t,s),n=!0},p(t,[n]){const s={};4&n&&(s.label=t[2]),1&n&&(s.screen=t[0]),2&n&&(s.item=t[1]),50&n&&(s.$$scope={dirty:n,ctx:t}),e.$set(s)},i(t){n||(O(e.$$.fragment,t),n=!0)},o(t){C(e.$$.fragment,t),n=!1},d(t){A(e,t)}}}function pn(t,e,n){let s;var{screen:a}=e,{item:r}=e;return t.$$set=t=>{"screen"in t&&n(0,a=t.screen),"item"in t&&n(1,r=t.item)},t.$$.update=()=>{2&t.$$.dirty&&n(2,s=function(t){if(t.type===Kt.HASH_REF)return $t[t.data].name;return t.title}(r)),2&t.$$.dirty&&K("screenItem",r)},[a,r,s]}class mn extends o{constructor(t){super(),u(this,t,pn,dn,f,{screen:0,item:1})}}function $n(t,e,n){const s=t.slice();return s[11]=e[n],s}function gn(t,e,n){const s=t.slice();return s[14]=e[n],s}function vn(t){let e,n,s,a,r,l=t[14].name+"";function i(){return t[10](t[14])}return{c(){e=h("button"),n=d(l),this.h()},l(t){e=$(t,"BUTTON",{class:!0});var s=g(e);n=v(s,l),s.forEach(y),this.h()},h(){b(e,"class",s=Q(t[14].id===t[1].id&&"current")+" svelte-1gt4vqn")},m(t,s){w(t,e,s),x(e,n),a||(r=I(e,"click",i),a=!0)},p(a,r){t=a,8&r&&l!==(l=t[14].name+"")&&T(n,l),10&r&&s!==(s=Q(t[14].id===t[1].id&&"current")+" svelte-1gt4vqn")&&b(e,"class",s)},d(t){t&&y(e),a=!1,r()}}}function yn(t,e){let n,s,a;return s=new mn({props:{campaign:e[0],item:e[11],screen:e[1]}}),{key:t,first:null,c(){n=m(),k(s.$$.fragment),this.h()},l(t){n=m(),N(s.$$.fragment,t),this.h()},h(){this.first=n},m(t,e){w(t,n,e),D(s,t,e),a=!0},p(t,n){e=t;const a={};1&n&&(a.campaign=e[0]),2&n&&(a.item=e[11]),2&n&&(a.screen=e[1]),s.$set(a)},i(t){a||(O(s.$$.fragment,t),a=!0)},o(t){C(s.$$.fragment,t),a=!1},d(t){t&&y(n),A(s,t)}}}function En(t){let e,n,s,a,r,l,i,c,o,u,f,d,m,v,T,k,N=[],P=new Map,D=t[3],A=[];for(let h=0;h<D.length;h+=1)A[h]=vn(gn(t,D,h));let V=t[1].items;const H=t=>t[11].id;for(let h=0;h<V.length;h+=1){let e=$n(t,V,h),n=H(e);P.set(n,N[h]=yn(n,e))}return{c(){e=h("section"),n=h("div");for(let t=0;t<A.length;t+=1)A[t].c();s=p(),a=h("button"),r=h("span"),l=p(),i=h("button"),c=h("span"),o=p(),u=h("button"),f=h("span"),d=p(),m=h("div");for(let t=0;t<N.length;t+=1)N[t].c();this.h()},l(t){e=$(t,"SECTION",{class:!0});var h=g(e);n=$(h,"DIV",{class:!0});var p=g(n);for(let e=0;e<A.length;e+=1)A[e].l(p);s=E(p),a=$(p,"BUTTON",{disabled:!0,class:!0});var v=g(a);r=$(v,"SPAN",{class:!0}),g(r).forEach(y),v.forEach(y),l=E(p),i=$(p,"BUTTON",{disabled:!0,class:!0});var b=g(i);c=$(b,"SPAN",{class:!0}),g(c).forEach(y),b.forEach(y),o=E(p),u=$(p,"BUTTON",{class:!0});var w=g(u);f=$(w,"SPAN",{class:!0}),g(f).forEach(y),w.forEach(y),p.forEach(y),d=E(h),m=$(h,"DIV",{class:!0});var x=g(m);for(let e=0;e<N.length;e+=1)N[e].l(x);x.forEach(y),h.forEach(y),this.h()},h(){b(r,"class","mdi mdi-pencil"),a.disabled=t[4],b(a,"class","svelte-1gt4vqn"),b(c,"class","mdi mdi-delete-outline"),i.disabled=t[4],b(i,"class","svelte-1gt4vqn"),b(f,"class","mdi mdi-plus"),b(u,"class","svelte-1gt4vqn"),b(n,"class","tabs svelte-1gt4vqn"),b(m,"class","grid svelte-1gt4vqn"),b(e,"class","dmScreen svelte-1gt4vqn")},m(h,p){w(h,e,p),x(e,n);for(let t=0;t<A.length;t+=1)A[t].m(n,null);x(n,s),x(n,a),x(a,r),x(n,l),x(n,i),x(i,c),x(n,o),x(n,u),x(u,f),x(e,d),x(e,m);for(let t=0;t<N.length;t+=1)N[t].m(m,null);v=!0,T||(k=[I(a,"click",t[8]),I(i,"click",t[7]),I(u,"click",t[6])],T=!0)},p(t,[e]){if(42&e){let a;for(D=t[3],a=0;a<D.length;a+=1){const r=gn(t,D,a);A[a]?A[a].p(r,e):(A[a]=vn(r),A[a].c(),A[a].m(n,s))}for(;a<A.length;a+=1)A[a].d(1);A.length=D.length}(!v||16&e)&&(a.disabled=t[4]),(!v||16&e)&&(i.disabled=t[4]),3&e&&(V=t[1].items,z(),N=Z(N,e,H,1,t,V,P,m,tt,yn,null,$n),B())},i(t){if(!v){for(let t=0;t<V.length;t+=1)O(N[t]);v=!0}},o(t){for(let e=0;e<N.length;e+=1)C(N[e]);v=!1},d(t){t&&y(e),S(A,t);for(let e=0;e<N.length;e+=1)N[e].d();T=!1,q(k)}}}function bn(t,e,n){let s,a,r,l,i,c=R;t.$$.on_destroy.push((()=>c()));var{campaign:o}=e;function u(t){o.screens.openScreen(t)}return t.$$set=t=>{"campaign"in t&&n(0,o=t.campaign)},t.$$.update=()=>{1&t.$$.dirty&&(n(2,s=o.campaignStore),c(),c=F(s,(t=>n(9,i=t)))),513&t.$$.dirty&&n(3,a=o.screens.get(i)),513&t.$$.dirty&&n(1,r=o.screens.getOpenScreen(i)),2&t.$$.dirty&&n(4,l="root"===r.id)},[o,r,s,a,l,u,function(){o.screens.newScreen()},function(){confirm("Are you sure you want to delete this tab?")&&o.screens.deleteScreen(r)},function(){var t=prompt("Type a name");t&&o.screens.renameCurrentScreen(t)},i,t=>u(t)]}function wn(t){let e,n,s,a,r,l,i,c;return{c(){e=h("div"),n=h("h4"),s=d(t[0]),a=h("span"),r=d("xp"),l=p(),i=h("h6"),c=d(t[1]),this.h()},l(o){e=$(o,"DIV",{class:!0});var u=g(e);n=$(u,"H4",{class:!0});var f=g(n);s=v(f,t[0]),a=$(f,"SPAN",{class:!0});var h=g(a);r=v(h,"xp"),h.forEach(y),f.forEach(y),l=E(u),i=$(u,"H6",{class:!0});var d=g(i);c=v(d,t[1]),d.forEach(y),u.forEach(y),this.h()},h(){b(a,"class","svelte-8oh2jc"),b(n,"class","svelte-8oh2jc"),b(i,"class","svelte-8oh2jc"),b(e,"class","svelte-8oh2jc")},m(t,o){w(t,e,o),x(e,n),x(n,s),x(n,a),x(a,r),x(e,l),x(e,i),x(i,c)},p(t,[e]){1&e&&T(s,t[0]),2&e&&T(c,t[1])},i:R,o:R,d(t){t&&y(e)}}}function xn(t,e,n){var{xp:s}=e,{difficulty:a}=e;return t.$$set=t=>{"xp"in t&&n(0,s=t.xp),"difficulty"in t&&n(1,a=t.difficulty)},[s,a]}class In extends o{constructor(t){super(),u(this,t,xn,wn,f,{xp:0,difficulty:1})}}function Tn(t,e,n){const s=t.slice();return s[9]=e[n],s}function Sn(t){let e,n;const s=[t[9]];let a={};for(let r=0;r<s.length;r+=1)a=st(a,s[r]);return e=new In({props:a}),{c(){k(e.$$.fragment)},l(t){N(e.$$.fragment,t)},m(t,s){D(e,t,s),n=!0},p(t,n){const a=16&n?et(s,[nt(t[9])]):{};e.$set(a)},i(t){n||(O(e.$$.fragment,t),n=!0)},o(t){C(e.$$.fragment,t),n=!1},d(t){A(e,t)}}}function kn(t){let e;return{c(){e=d("Save encounter")},l(t){e=v(t,"Save encounter")},m(t,n){w(t,e,n)},d(t){t&&y(e)}}}function Nn(t){let e,n,s,a,r,l,i,c,o,u,f,m,I,P,V,H,R,q,M,j,U,L=t[4],F=[];for(let h=0;h<L.length;h+=1)F[h]=Sn(Tn(t,L,h));const X=t=>C(F[t],1,1,(()=>{F[t]=null}));return V=new Ae({props:{items:t[1],remove:!0,tiny:!0,popup:!0,hidePopupIndicator:!0}}),V.$on("remove",t[5]),j=new Pt({props:{$$slots:{default:[kn]},$$scope:{ctx:t}}}),j.$on("click",t[6]),{c(){e=h("div"),n=h("header"),s=h("div");for(let t=0;t<F.length;t+=1)F[t].c();a=p(),r=h("div"),l=h("h1"),i=h("span"),c=d(t[3]),u=p(),f=h("span"),m=d(t[2]),I=d("xp"),P=p(),k(V.$$.fragment),H=p(),R=h("footer"),q=h("input"),M=p(),k(j.$$.fragment),this.h()},l(o){e=$(o,"DIV",{class:!0});var h=g(e);n=$(h,"HEADER",{});var d=g(n);s=$(d,"DIV",{class:!0});var p=g(s);for(let t=0;t<F.length;t+=1)F[t].l(p);p.forEach(y),a=E(d),r=$(d,"DIV",{});var b=g(r);l=$(b,"H1",{class:!0});var w=g(l);i=$(w,"SPAN",{class:!0});var x=g(i);c=v(x,t[3]),x.forEach(y),u=E(w),f=$(w,"SPAN",{class:!0});var T=g(f);m=v(T,t[2]),I=v(T,"xp"),T.forEach(y),w.forEach(y),b.forEach(y),d.forEach(y),P=E(h),N(V.$$.fragment,h),H=E(h),R=$(h,"FOOTER",{class:!0});var S=g(R);q=$(S,"INPUT",{}),M=E(S),N(j.$$.fragment,S),S.forEach(y),h.forEach(y),this.h()},h(){b(s,"class","challengeLevels svelte-i7tvej"),b(i,"class",o="difficulty "+t[3]+" svelte-i7tvej"),b(f,"class","xp svelte-i7tvej"),b(l,"class","svelte-i7tvej"),b(R,"class","svelte-i7tvej"),b(e,"class","sections")},m(t,o){w(t,e,o),x(e,n),x(n,s);for(let e=0;e<F.length;e+=1)F[e].m(s,null);x(n,a),x(n,r),x(r,l),x(l,i),x(i,c),x(l,u),x(l,f),x(f,m),x(f,I),x(e,P),D(V,e,null),x(e,H),x(e,R),x(R,q),x(R,M),D(j,R,null),U=!0},p(t,[e]){if(16&e){let n;for(L=t[4],n=0;n<L.length;n+=1){const a=Tn(t,L,n);F[n]?(F[n].p(a,e),O(F[n],1)):(F[n]=Sn(a),F[n].c(),O(F[n],1),F[n].m(s,null))}for(z(),n=L.length;n<F.length;n+=1)X(n);B()}(!U||8&e)&&T(c,t[3]),(!U||8&e&&o!==(o="difficulty "+t[3]+" svelte-i7tvej"))&&b(i,"class",o),(!U||4&e)&&T(m,t[2]);const n={};2&e&&(n.items=t[1]),V.$set(n);const a={};4096&e&&(a.$$scope={dirty:e,ctx:t}),j.$set(a)},i(t){if(!U){for(let t=0;t<L.length;t+=1)O(F[t]);O(V.$$.fragment,t),O(j.$$.fragment,t),U=!0}},o(t){F=F.filter(Boolean);for(let e=0;e<F.length;e+=1)C(F[e]);C(V.$$.fragment,t),C(j.$$.fragment,t),U=!1},d(t){t&&y(e),S(F,t),A(V),A(j)}}}function Pn(t,e,n){let s,a,r,l,i,c=R,o=()=>(c(),c=F(u,(t=>n(8,i=t))),u);t.$$.on_destroy.push((()=>c()));var{campaign:u=M("campaign")}=e;o();var{encounter:f}=e;return t.$$set=t=>{"campaign"in t&&o(n(0,u=t.campaign)),"encounter"in t&&n(7,f=t.encounter)},t.$$.update=()=>{128&t.$$.dirty&&n(1,s=f.getMonsters()),128&t.$$.dirty&&n(2,a=f.getEncounterXP()),384&t.$$.dirty&&n(3,r=f.getEncounterDifficulty(i.party.getXPThreshHolds())),256&t.$$.dirty&&n(4,l=Object.entries(i.party.getXPThreshHolds()).map((([t,e])=>({xp:e,difficulty:Nt(t)}))))},[u,s,a,r,l,function({detail:t}){f.removeMonster(t),n(7,f)},function(){u.screens.addItemToCurrentScreen("New encounter","encounter",f)},f,i]}class Dn extends o{constructor(t){super(),u(this,t,Pn,Nn,f,{campaign:0,encounter:7})}}function On(t,e,n){const s=t.slice();return s[3]=e[n],s}function Cn(t){let e,n,s,a=t[3].text+"";return{c(){e=h("option"),n=d(a),this.h()},l(t){e=$(t,"OPTION",{value:!0});var s=g(e);n=v(s,a),s.forEach(y),this.h()},h(){e.__value=s=t[3].value,e.value=e.__value},m(t,s){w(t,e,s),x(e,n)},p:R,d(t){t&&y(e)}}}function An(t){let e,n,s,a=t[1],r=[];for(let l=0;l<a.length;l+=1)r[l]=Cn(On(t,a,l));return{c(){e=h("select");for(let t=0;t<r.length;t+=1)r[t].c();this.h()},l(t){e=$(t,"SELECT",{class:!0});var n=g(e);for(let e=0;e<r.length;e+=1)r[e].l(n);n.forEach(y),this.h()},h(){b(e,"class","svelte-17oxtdk"),void 0===t[0]&&W((()=>t[2].call(e)))},m(a,l){w(a,e,l);for(let t=0;t<r.length;t+=1)r[t].m(e,null);G(e,t[0]),n||(s=I(e,"change",t[2]),n=!0)},p(t,[n]){if(2&n){let s;for(a=t[1],s=0;s<a.length;s+=1){const l=On(t,a,s);r[s]?r[s].p(l,n):(r[s]=Cn(l),r[s].c(),r[s].m(e,null))}for(;s<r.length;s+=1)r[s].d(1);r.length=a.length}3&n&&G(e,t[0])},i:R,o:R,d(t){t&&y(e),S(r,t),n=!1,s()}}}function Vn(t){return 0===t?"0":1===t?"1/8":2===t?"1/4":3===t?"1/2":String(t-3)}function zn(t,e,n){var s,{cr:a}=e,r=[];for(let l=0;l<=33;l++)r.push({value:(s=l,0===s?0:1===s?.125:2===s?.25:3===s?.5:s-3),text:Vn(l)});return t.$$set=t=>{"cr"in t&&n(0,a=t.cr)},[a,r,function(){a=J(this),n(0,a),n(1,r)}]}class Bn extends o{constructor(t){super(),u(this,t,zn,An,f,{cr:0})}}function Hn(t){let e,n,s,a,r,l,i,c,o,u,f,m,I,T,S;function P(e){t[2](e)}let z={};function B(e){t[3](e)}void 0!==t[0]&&(z.cr=t[0]),l=new Bn({props:z}),V.push((()=>j(l,"cr",P)));let H={};return void 0!==t[1]&&(H.cr=t[1]),I=new Bn({props:H}),V.push((()=>j(I,"cr",B))),{c(){e=h("div"),n=h("div"),s=h("h6"),a=d("Min"),r=p(),k(l.$$.fragment),c=p(),o=h("div"),u=h("h6"),f=d("Max"),m=p(),k(I.$$.fragment),this.h()},l(t){e=$(t,"DIV",{class:!0});var i=g(e);n=$(i,"DIV",{class:!0});var h=g(n);s=$(h,"H6",{class:!0});var d=g(s);a=v(d,"Min"),d.forEach(y),r=E(h),N(l.$$.fragment,h),h.forEach(y),c=E(i),o=$(i,"DIV",{class:!0});var p=g(o);u=$(p,"H6",{class:!0});var b=g(u);f=v(b,"Max"),b.forEach(y),m=E(p),N(I.$$.fragment,p),p.forEach(y),i.forEach(y),this.h()},h(){b(s,"class","svelte-1l2sto3"),b(n,"class","svelte-1l2sto3"),b(u,"class","svelte-1l2sto3"),b(o,"class","svelte-1l2sto3"),b(e,"class","crRangeSelect svelte-1l2sto3")},m(t,i){w(t,e,i),x(e,n),x(n,s),x(s,a),x(n,r),D(l,n,null),x(e,c),x(e,o),x(o,u),x(u,f),x(o,m),D(I,o,null),S=!0},p(t,[e]){const n={};!i&&1&e&&(i=!0,n.cr=t[0],U((()=>i=!1))),l.$set(n);const s={};!T&&2&e&&(T=!0,s.cr=t[1],U((()=>T=!1))),I.$set(s)},i(t){S||(O(l.$$.fragment,t),O(I.$$.fragment,t),S=!0)},o(t){C(l.$$.fragment,t),C(I.$$.fragment,t),S=!1},d(t){t&&y(e),A(l),A(I)}}}function Rn(t,e,n){var{min:s=0}=e,{max:a=30}=e;return t.$$set=t=>{"min"in t&&n(0,s=t.min),"max"in t&&n(1,a=t.max)},[s,a,function(t){n(0,s=t)},function(t){n(1,a=t)}]}class qn extends o{constructor(t){super(),u(this,t,Rn,Hn,f,{min:0,max:1})}}function Mn(t){let e,n,s,a,r,l,i,c,o,u,f,m,T,S,P,z,B,R,q,M,L;function F(e){t[6](e)}function X(e){t[7](e)}let _={};function W(e){t[8](e)}void 0!==t[1]&&(_.min=t[1]),void 0!==t[2]&&(_.max=t[2]),u=new qn({props:_}),V.push((()=>j(u,"min",F))),V.push((()=>j(u,"max",X)));let G={possibleValues:At()};return void 0!==t[3]&&(G.selectedValues=t[3]),B=new Lt({props:G}),V.push((()=>j(B,"selectedValues",W))),{c(){e=h("div"),n=h("h3"),s=d("Search"),a=p(),r=h("input"),l=p(),i=h("h3"),c=d("Challenge rating"),o=p(),k(u.$$.fragment),T=p(),S=h("h3"),P=d("Environment"),z=p(),k(B.$$.fragment),this.h()},l(t){e=$(t,"DIV",{});var f=g(e);n=$(f,"H3",{class:!0});var h=g(n);s=v(h,"Search"),h.forEach(y),a=E(f),r=$(f,"INPUT",{class:!0}),l=E(f),i=$(f,"H3",{class:!0});var d=g(i);c=v(d,"Challenge rating"),d.forEach(y),o=E(f),N(u.$$.fragment,f),T=E(f),S=$(f,"H3",{class:!0});var p=g(S);P=v(p,"Environment"),p.forEach(y),z=E(f),N(B.$$.fragment,f),f.forEach(y),this.h()},h(){b(n,"class","svelte-1kicwjl"),b(r,"class","svelte-1kicwjl"),b(i,"class","svelte-1kicwjl"),b(S,"class","svelte-1kicwjl")},m(f,h){w(f,e,h),x(e,n),x(n,s),x(e,a),x(e,r),H(r,t[0]),x(e,l),x(e,i),x(i,c),x(e,o),D(u,e,null),x(e,T),x(e,S),x(S,P),x(e,z),D(B,e,null),q=!0,M||(L=I(r,"input",t[5]),M=!0)},p(t,[e]){1&e&&r.value!==t[0]&&H(r,t[0]);const n={};!f&&2&e&&(f=!0,n.min=t[1],U((()=>f=!1))),!m&&4&e&&(m=!0,n.max=t[2],U((()=>m=!1))),u.$set(n);const s={};!R&&8&e&&(R=!0,s.selectedValues=t[3],U((()=>R=!1))),B.$set(s)},i(t){q||(O(u.$$.fragment,t),O(B.$$.fragment,t),q=!0)},o(t){C(u.$$.fragment,t),C(B.$$.fragment,t),q=!1},d(t){t&&y(e),A(u),A(B),M=!1,L()}}}function jn(t,e,n){var{filtering:s={query:a,cr:{min:0,max:30},environments:[]}}=e,a="",r=0,l=30,i=[];return t.$$set=t=>{"filtering"in t&&n(4,s=t.filtering)},t.$$.update=()=>{15&t.$$.dirty&&(n(4,s.query=a,s),n(4,s.cr.min=r,s),n(4,s.cr.max=l,s),n(4,s.environments=i,s))},[a,r,l,i,s,function(){a=this.value,n(0,a)},function(t){n(1,r=t)},function(t){n(2,l=t)},function(t){n(3,i=t)}]}class Un extends o{constructor(t){super(),u(this,t,jn,Mn,f,{filtering:4})}}function Ln(t){let e,n,s,a,r,l,i,c,o,u,f,d;function m(e){t[4](e)}let v={};function I(e){t[5](e)}void 0!==t[0]&&(v.filtering=t[0]),s=new Un({props:v}),V.push((()=>j(s,"filtering",m)));let T={items:t[2],limit:100,cr:!0,environments:!0,popup:!0,alignment:!0};return void 0!==t[1]&&(T.encounter=t[1]),i=new Ae({props:T}),V.push((()=>j(i,"encounter",I))),f=new Dn({props:{encounter:t[1]}}),{c(){e=h("section"),n=h("div"),k(s.$$.fragment),r=p(),l=h("div"),k(i.$$.fragment),o=p(),u=h("div"),k(f.$$.fragment),this.h()},l(t){e=$(t,"SECTION",{class:!0});var a=g(e);n=$(a,"DIV",{class:!0});var c=g(n);N(s.$$.fragment,c),c.forEach(y),r=E(a),l=$(a,"DIV",{class:!0});var h=g(l);N(i.$$.fragment,h),h.forEach(y),o=E(a),u=$(a,"DIV",{class:!0});var d=g(u);N(f.$$.fragment,d),d.forEach(y),a.forEach(y),this.h()},h(){b(n,"class","filters svelte-o4kxqt"),b(l,"class","monsters svelte-o4kxqt"),b(u,"class","currentEncounter svelte-o4kxqt"),b(e,"class","encounterBuilder svelte-o4kxqt")},m(t,a){w(t,e,a),x(e,n),D(s,n,null),x(e,r),x(e,l),D(i,l,null),x(e,o),x(e,u),D(f,u,null),d=!0},p(t,[e]){const n={};!a&&1&e&&(a=!0,n.filtering=t[0],U((()=>a=!1))),s.$set(n);const r={};4&e&&(r.items=t[2]),!c&&2&e&&(c=!0,r.encounter=t[1],U((()=>c=!1))),i.$set(r);const l={};2&e&&(l.encounter=t[1]),f.$set(l)},i(t){d||(O(s.$$.fragment,t),O(i.$$.fragment,t),O(f.$$.fragment,t),d=!0)},o(t){C(s.$$.fragment,t),C(i.$$.fragment,t),C(f.$$.fragment,t),d=!1},d(t){t&&y(e),A(s),A(i),A(f)}}}function Fn(t,e,n){let s;var{campaign:a=M("campaign")}=e,r=De(),l=Object.values(xt),i={query:"",cr:{min:0,max:30},environments:[]};return t.$$set=t=>{"campaign"in t&&n(3,a=t.campaign)},t.$$.update=()=>{1&t.$$.dirty&&n(2,s=l.filter((t=>{let e=t.name.toLowerCase().includes(i.query.toLowerCase()),n=t.getCRValue()>=i.cr.min&&t.getCRValue()<=i.cr.max,s=0===i.environments.length||i.environments.some((e=>{var n;return null===(n=t.environment)||void 0===n?void 0:n.includes(e.toLowerCase())}));return e&&n&&s})))},[i,r,s,a,function(t){n(0,i=t)},function(t){n(1,r=t)}]}var Xn,_n;function Wn(t){let e;return{c(){e=d("Optimize for tablet")},l(t){e=v(t,"Optimize for tablet")},m(t,n){w(t,e,n)},d(t){t&&y(e)}}}function Gn(t){let e,n,s,a,r,l,i,c,o,u,f,m,I,T,S;function P(e){t[4](e)}let z={$$slots:{default:[Wn]},$$scope:{ctx:t}};return void 0!==t[2].settings.optimizeTablet&&(z.value=t[2].settings.optimizeTablet),I=new _t({props:z}),V.push((()=>j(I,"value",P))),{c(){e=h("section"),n=h("div"),s=h("h2"),a=d("General settings"),r=p(),l=h("p"),i=d("Only change the dataset for this campaign when updating an old dataset or you're absolutely sure the new dataset is compatible with the old one."),c=p(),o=h("div"),u=h("h2"),f=d("Tablet settings"),m=p(),k(I.$$.fragment),this.h()},l(t){e=$(t,"SECTION",{class:!0});var h=g(e);n=$(h,"DIV",{class:!0});var d=g(n);s=$(d,"H2",{});var p=g(s);a=v(p,"General settings"),p.forEach(y),r=E(d),l=$(d,"P",{});var b=g(l);i=v(b,"Only change the dataset for this campaign when updating an old dataset or you're absolutely sure the new dataset is compatible with the old one."),b.forEach(y),d.forEach(y),c=E(h),o=$(h,"DIV",{class:!0});var w=g(o);u=$(w,"H2",{});var x=g(u);f=v(x,"Tablet settings"),x.forEach(y),m=E(w),N(I.$$.fragment,w),w.forEach(y),h.forEach(y),this.h()},h(){b(n,"class","generalSettings svelte-1nz9qmn"),b(o,"class","tabletSettings svelte-1nz9qmn"),b(e,"class","settings svelte-1nz9qmn")},m(t,h){w(t,e,h),x(e,n),x(n,s),x(s,a),x(n,r),x(n,l),x(l,i),x(e,c),x(e,o),x(o,u),x(u,f),x(o,m),D(I,o,null),S=!0},p(t,[e]){const n={};32&e&&(n.$$scope={dirty:e,ctx:t}),!T&&4&e&&(T=!0,n.value=t[2].settings.optimizeTablet,U((()=>T=!1))),I.$set(n)},i(t){S||(O(I.$$.fragment,t),S=!0)},o(t){C(I.$$.fragment,t),S=!1},d(t){t&&y(e),A(I)}}}function Yn(t,e,n){let s,a,r,l=R,i=()=>(l(),l=F(o,(t=>n(3,a=t))),o),c=R;t.$$.on_destroy.push((()=>l())),t.$$.on_destroy.push((()=>c()));var{campaign:o=M("campaign")}=e;return i(),t.$$set=t=>{"campaign"in t&&i(n(0,o=t.campaign))},t.$$.update=()=>{8&t.$$.dirty&&(n(1,s=a.campaignStore),c(),c=F(s,(t=>n(2,r=t))))},[o,s,r,a,function(e){t.$$.not_equal(r.settings.optimizeTablet,e)&&(r.settings.optimizeTablet=e,s.set(r))}]}(_n=Xn||(Xn={}))[_n.POPUP=0]="POPUP",_n[_n.ACTION=1]="ACTION",_n[_n.SPECIAL=2]="SPECIAL";class Jn extends o{constructor(t){super(),u(this,t,null,null,f,{})}}const Kn={type:"folder",icon:"folder-outline",color:"#db1d56",behavior:Xn.SPECIAL,name:"Folder",description:"Group buttons together in a folder.",tags:["Misc"],editor:Jn,defaultState:{buttons:[]}};function Qn(t){let e,n;return e=new ge({}),{c(){k(e.$$.fragment)},l(t){N(e.$$.fragment,t)},m(t,s){D(e,t,s),n=!0},p:R,i(t){n||(O(e.$$.fragment,t),n=!0)},o(t){C(e.$$.fragment,t),n=!1},d(t){A(e,t)}}}function Zn(t,e,n){var{state:s}=e;return t.$$set=t=>{"state"in t&&n(0,s=t.state)},[s]}const ts={type:"reference",icon:"book-open-blank-variant",color:"#32805f",behavior:Xn.POPUP,name:"Reference",description:"Shows a popup for an item you've selected.",tags:["Misc"],editorForm:[{key:"hash",label:"Reference item",type:Gt.DATA_ENTRY}],defaultState:{hash:""},popupContent:class extends o{constructor(t){super(),u(this,t,Zn,Qn,f,{state:0})}}},es={type:"webpage",icon:"web",color:"#2a5eb8",behavior:Xn.ACTION,name:"Web page",description:"Opens the selected url in a new page.",tags:["Misc"],editorForm:[{key:"url",label:"URL",type:Gt.TEXT,default:"https://google.com"}],defaultState:{url:""},action:t=>{console.log(t),window.open(t.url,"_blank")}},ns={type:"playSoundFile",icon:"volume-high",color:"#131c66",behavior:Xn.ACTION,name:"Play sound",description:"Plays a sound file you can upload.",tags:["Misc"],defaultState:{},action:t=>{}};var ss={folder:Kn,referenceDefinition:ts,webPageDefinition:es,playSoundFileDefinition:ns,spotifyPlaylistDefinition:{type:"spotifyPlaylist",icon:"spotify",color:"#1db954",behavior:Xn.ACTION,name:"Spotify playlist",description:"Starts playback of the selected playlist.",tags:["Spotify"],editor:class extends o{constructor(t){super(),u(this,t,null,null,f,{})}},defaultState:{playlistUrl:""},action:t=>{}},spotifyPause:{type:"spotifyPause",icon:"play-pause",color:"#1db954",behavior:Xn.ACTION,name:"Play/pause spotify",description:"Pauses and plays the current spotify session.",tags:["Spotify"],action:t=>{}},hueScene:{type:"hueScene",icon:"lightbulb-outline",color:"#15d7c0",behavior:Xn.ACTION,name:"Hue scene",description:"Set your hue lights to a specific scene.",tags:["Philips Hue"],editor:Jn,defaultState:{},action:t=>{}}};function as(t,e,n){const s=t.slice();return s[7]=e[n],s}function rs(t,e,n){const s=t.slice();return s[10]=e[n],s}function ls(t){let e,n,s,a=t[10]+"";return{c(){e=h("li"),n=d(a),s=p(),this.h()},l(t){e=$(t,"LI",{class:!0});var r=g(e);n=v(r,a),s=E(r),r.forEach(y),this.h()},h(){b(e,"class","svelte-1gqk8qq")},m(t,a){w(t,e,a),x(e,n),x(e,s)},p(t,e){2&e&&a!==(a=t[10]+"")&&T(n,a)},d(t){t&&y(e)}}}function is(t){let e,n,s,a,r,l,i,c,o,u,f,m,S=t[7].name+"",k=t[7].description+"";function N(){return t[3](t[7])}return{c(){e=h("div"),n=h("h4"),s=h("span"),r=p(),l=d(S),i=p(),c=h("p"),o=d(k),u=p(),this.h()},l(t){e=$(t,"DIV",{class:!0,style:!0});var a=g(e);n=$(a,"H4",{class:!0});var f=g(n);s=$(f,"SPAN",{class:!0}),g(s).forEach(y),r=E(f),l=v(f,S),f.forEach(y),i=E(a),c=$(a,"P",{});var h=g(c);o=v(h,k),h.forEach(y),u=E(a),a.forEach(y),this.h()},h(){b(s,"class",a="mdi mdi-"+t[7].icon+" svelte-1gqk8qq"),b(n,"class","svelte-1gqk8qq"),b(e,"class","button svelte-1gqk8qq"),P(e,"background-color",t[7].color)},m(t,a){w(t,e,a),x(e,n),x(n,s),x(n,r),x(n,l),x(e,i),x(e,c),x(c,o),x(e,u),f||(m=I(e,"click",N),f=!0)},p(n,r){t=n,1&r&&a!==(a="mdi mdi-"+t[7].icon+" svelte-1gqk8qq")&&b(s,"class",a),1&r&&S!==(S=t[7].name+"")&&T(l,S),1&r&&k!==(k=t[7].description+"")&&T(o,k),1&r&&P(e,"background-color",t[7].color)},d(t){t&&y(e),f=!1,m()}}}function cs(t){let e,n,s,a,r,l,i,c,o,u,f,m,I=t[1],T=[];for(let h=0;h<I.length;h+=1)T[h]=ls(rs(t,I,h));let k=t[0],N=[];for(let h=0;h<k.length;h+=1)N[h]=is(as(t,k,h));return{c(){e=h("div"),n=h("aside"),s=h("header"),a=h("h1"),r=d("Categories"),l=p(),i=h("ul"),c=h("li"),o=d("All"),u=p();for(let t=0;t<T.length;t+=1)T[t].c();f=p(),m=h("section");for(let t=0;t<N.length;t+=1)N[t].c();this.h()},l(t){e=$(t,"DIV",{class:!0});var h=g(e);n=$(h,"ASIDE",{class:!0});var d=g(n);s=$(d,"HEADER",{});var p=g(s);a=$(p,"H1",{});var b=g(a);r=v(b,"Categories"),b.forEach(y),p.forEach(y),l=E(d),i=$(d,"UL",{class:!0});var w=g(i);c=$(w,"LI",{class:!0});var x=g(c);o=v(x,"All"),x.forEach(y),u=E(w);for(let e=0;e<T.length;e+=1)T[e].l(w);w.forEach(y),d.forEach(y),f=E(h),m=$(h,"SECTION",{class:!0});var I=g(m);for(let e=0;e<N.length;e+=1)N[e].l(I);I.forEach(y),h.forEach(y),this.h()},h(){b(c,"class","svelte-1gqk8qq"),b(i,"class","svelte-1gqk8qq"),b(n,"class","svelte-1gqk8qq"),b(m,"class","svelte-1gqk8qq"),b(e,"class","newButton svelte-1gqk8qq")},m(t,h){w(t,e,h),x(e,n),x(n,s),x(s,a),x(a,r),x(n,l),x(n,i),x(i,c),x(c,o),x(i,u);for(let e=0;e<T.length;e+=1)T[e].m(i,null);x(e,f),x(e,m);for(let e=0;e<N.length;e+=1)N[e].m(m,null)},p(t,[e]){if(2&e){let n;for(I=t[1],n=0;n<I.length;n+=1){const s=rs(t,I,n);T[n]?T[n].p(s,e):(T[n]=ls(s),T[n].c(),T[n].m(i,null))}for(;n<T.length;n+=1)T[n].d(1);T.length=I.length}if(5&e){let n;for(k=t[0],n=0;n<k.length;n+=1){const s=as(t,k,n);N[n]?N[n].p(s,e):(N[n]=is(s),N[n].c(),N[n].m(m,null))}for(;n<N.length;n+=1)N[n].d(1);N.length=k.length}},i:R,o:R,d(t){t&&y(e),S(T,t),S(N,t)}}}function os(t,e,n){let s,a;const r=L();function l(t){r("select",t)}M("campaign");return t.$$.update=()=>{1&t.$$.dirty&&n(1,a=function(t){let e=new Set;for(let n of t)for(let t of n.tags)e.add(t);return[...e]}(s))},n(0,s=Object.values(ss)),[s,a,l,t=>l(t)]}class us extends o{constructor(t){super(),u(this,t,os,cs,f,{})}}function fs(t){let e=function(t){"#"===t[0]&&(t=t.replace("#",""));let e=parseInt(t,16);return{r:e>>16&255,g:e>>8&255,b:255&e}}(t);return Math.round((299*e.r+587*e.g+114*e.b)/1e3)>125?"#000000":"#ffffff"}function hs(t,e,n=500){let s,a=()=>{console.log("down"),s=setTimeout((()=>{clearTimeout(s),t.blur(),e()}),n)},r=()=>{console.log("Up"),clearTimeout(s)};return t.addEventListener("pointerdown",a),window.addEventListener("pointerup",r),{destroy(){t.removeEventListener("pointerdown",a),window.removeEventListener("pointerup",r)}}}function ds(t){let e,n,s;return{c(){e=h("div"),n=h("span"),this.h()},l(t){e=$(t,"DIV",{style:!0,class:!0});var s=g(e);n=$(s,"SPAN",{class:!0}),g(n).forEach(y),s.forEach(y),this.h()},h(){b(n,"class",s="mdi mdi-"+t[1]),P(e,"background-color",t[0]),P(e,"color",t[2]),b(e,"class","svelte-1a2szru")},m(t,s){w(t,e,s),x(e,n)},p(t,[a]){2&a&&s!==(s="mdi mdi-"+t[1])&&b(n,"class",s),1&a&&P(e,"background-color",t[0]),4&a&&P(e,"color",t[2])},i:R,o:R,d(t){t&&y(e)}}}function ps(t,e,n){let s,a,r;var{button:l}=e;return t.$$set=t=>{"button"in t&&n(3,l=t.button)},t.$$.update=()=>{8&t.$$.dirty&&n(1,s=l.icon),8&t.$$.dirty&&n(0,a=l.color),1&t.$$.dirty&&n(2,r=fs(a))},[a,s,r,l]}class ms extends o{constructor(t){super(),u(this,t,ps,ds,f,{button:3})}}function $s(t,e,n){const s=t.slice();return s[7]=e[n],s}function gs(t){let e,n,s,a,r,l;function i(){return t[4](t[7])}return{c(){e=h("button"),n=h("span"),a=p(),this.h()},l(t){e=$(t,"BUTTON",{class:!0});var s=g(e);n=$(s,"SPAN",{class:!0}),g(n).forEach(y),a=E(s),s.forEach(y),this.h()},h(){b(n,"class",s="mdi mdi-"+t[7].name+" svelte-1h4axbv"),b(e,"class","svelte-1h4axbv")},m(t,s){w(t,e,s),x(e,n),x(e,a),r||(l=I(e,"click",i),r=!0)},p(e,a){t=e,2&a&&s!==(s="mdi mdi-"+t[7].name+" svelte-1h4axbv")&&b(n,"class",s)},d(t){t&&y(e),r=!1,l()}}}function vs(t){let e,n,s,a,r,l,i,c,o;function u(e){t[3](e)}let f={label:"Search"};void 0!==t[0]&&(f.value=t[0]),s=new Vt({props:f}),V.push((()=>j(s,"value",u)));let d=t[1],m=[];for(let h=0;h<d.length;h+=1)m[h]=gs($s(t,d,h));return{c(){e=h("section"),n=h("header"),k(s.$$.fragment),r=p(),l=h("hr"),i=p(),c=h("div");for(let t=0;t<m.length;t+=1)m[t].c();this.h()},l(t){e=$(t,"SECTION",{});var a=g(e);n=$(a,"HEADER",{});var o=g(n);N(s.$$.fragment,o),o.forEach(y),r=E(a),l=$(a,"HR",{class:!0}),i=E(a),c=$(a,"DIV",{class:!0});var u=g(c);for(let e=0;e<m.length;e+=1)m[e].l(u);u.forEach(y),a.forEach(y),this.h()},h(){b(l,"class","svelte-1h4axbv"),b(c,"class","grid svelte-1h4axbv")},m(t,a){w(t,e,a),x(e,n),D(s,n,null),x(e,r),x(e,l),x(e,i),x(e,c);for(let e=0;e<m.length;e+=1)m[e].m(c,null);o=!0},p(t,[e]){const n={};if(!a&&1&e&&(a=!0,n.value=t[0],U((()=>a=!1))),s.$set(n),6&e){let n;for(d=t[1],n=0;n<d.length;n+=1){const s=$s(t,d,n);m[n]?m[n].p(s,e):(m[n]=gs(s),m[n].c(),m[n].m(c,null))}for(;n<m.length;n+=1)m[n].d(1);m.length=d.length}},i(t){o||(O(s.$$.fragment,t),o=!0)},o(t){C(s.$$.fragment,t),o=!1},d(t){t&&y(e),A(s),S(m,t)}}}function ys(t,e,n){let s;const a=L();let r="";function l(t){a("select",t.name)}return t.$$.update=()=>{1&t.$$.dirty&&n(1,s=zt.filter((t=>{let e=r.toLowerCase(),n=t.name.toLowerCase().includes(e),s=t.aliases.some((t=>t.toLowerCase().includes(e)));return n||s})))},[r,s,l,function(t){r=t,n(0,r)},t=>l(t)]}class Es extends o{constructor(t){super(),u(this,t,ys,vs,f,{})}}function bs(t){let e,n,s;function a(e){t[3](e)}let r={shape:t[1]};return void 0!==t[0].state&&(r.value=t[0].state),e=new Yt({props:r}),V.push((()=>j(e,"value",a))),{c(){k(e.$$.fragment)},l(t){N(e.$$.fragment,t)},m(t,n){D(e,t,n),s=!0},p(t,[s]){const a={};2&s&&(a.shape=t[1]),!n&&1&s&&(n=!0,a.value=t[0].state,U((()=>n=!1))),e.$set(a)},i(t){s||(O(e.$$.fragment,t),s=!0)},o(t){C(e.$$.fragment,t),s=!1},d(t){A(e,t)}}}function ws(t,e,n){let s,a;var{button:r}=e;return t.$$set=t=>{"button"in t&&n(0,r=t.button)},t.$$.update=()=>{1&t.$$.dirty&&n(2,s=r.getDefinition()),4&t.$$.dirty&&n(1,a=s.editorForm)},[r,a,s,function(e){t.$$.not_equal(r.state,e)&&(r.state=e,n(0,r))}]}class xs extends o{constructor(t){super(),u(this,t,ws,bs,f,{button:0})}}function Is(t){let e,n;return{c(){e=h("span"),n=d("\n                Save"),this.h()},l(t){e=$(t,"SPAN",{class:!0}),g(e).forEach(y),n=v(t,"\n                Save"),this.h()},h(){b(e,"class","mdi mdi-content-save-outline")},m(t,s){w(t,e,s),w(t,n,s)},d(t){t&&y(e),t&&y(n)}}}function Ts(t){let e,n;return{c(){e=h("span"),n=d("\n                Remove"),this.h()},l(t){e=$(t,"SPAN",{class:!0}),g(e).forEach(y),n=v(t,"\n                Remove"),this.h()},h(){b(e,"class","mdi mdi-delete-outline")},m(t,s){w(t,e,s),w(t,n,s)},d(t){t&&y(e),t&&y(n)}}}function Ss(t){let e,n,s;var a=t[5];function r(t){return{props:{button:t[0]}}}return a&&(n=new a(r(t))),{c(){e=h("div"),n&&k(n.$$.fragment),this.h()},l(t){e=$(t,"DIV",{class:!0});var s=g(e);n&&N(n.$$.fragment,s),s.forEach(y),this.h()},h(){b(e,"class","editor")},m(t,a){w(t,e,a),n&&D(n,e,null),s=!0},p(t,s){const l={};if(1&s&&(l.button=t[0]),a!==(a=t[5])){if(n){z();const t=n;C(t.$$.fragment,1,0,(()=>{A(t,1)})),B()}a?(n=new a(r(t)),k(n.$$.fragment),O(n.$$.fragment,1),D(n,e,null)):n=null}else a&&n.$set(l)},i(t){s||(n&&O(n.$$.fragment,t),s=!0)},o(t){n&&C(n.$$.fragment,t),s=!1},d(t){t&&y(e),n&&A(n)}}}function ks(t){let e,n;return e=new Es({}),e.$on("select",t[6]),{c(){k(e.$$.fragment)},l(t){N(e.$$.fragment,t)},m(t,s){D(e,t,s),n=!0},p:R,i(t){n||(O(e.$$.fragment,t),n=!0)},o(t){C(e.$$.fragment,t),n=!1},d(t){A(e,t)}}}function Ns(t){let e,n,s,a,r,l,i,c,o,u,f,d,m,v,T,S,R,M,L,F,X,_,W,G,Y,J;S=new Wt({props:{$$slots:{default:[Is]},$$scope:{ctx:t}}}),S.$on("click",t[8]),M=new Wt({props:{$$slots:{default:[Ts]},$$scope:{ctx:t}}}),M.$on("click",t[9]);let K=null!==t[5]&&Ss(t);function Q(e){t[15](e)}let Z={min:!0,$$slots:{default:[ks]},$$scope:{ctx:t}};return void 0!==t[3]&&(Z.open=t[3]),_=new Dt({props:Z}),V.push((()=>j(_,"open",Q))),{c(){e=h("section"),n=h("header"),s=h("button"),a=h("span"),l=p(),i=h("button"),c=h("span"),o=p(),u=h("input"),f=p(),d=h("input"),m=p(),v=h("div"),T=h("div"),k(S.$$.fragment),R=p(),L=h("div"),k(M.$$.fragment),F=p(),K&&K.c(),X=p(),k(_.$$.fragment),this.h()},l(t){e=$(t,"SECTION",{class:!0});var r=g(e);n=$(r,"HEADER",{style:!0,class:!0});var h=g(n);s=$(h,"BUTTON",{class:!0});var p=g(s);a=$(p,"SPAN",{class:!0}),g(a).forEach(y),p.forEach(y),l=E(h),i=$(h,"BUTTON",{class:!0});var b=g(i);c=$(b,"SPAN",{class:!0,style:!0}),g(c).forEach(y),o=E(b),u=$(b,"INPUT",{type:!0,class:!0}),b.forEach(y),f=E(h),d=$(h,"INPUT",{type:!0,class:!0}),h.forEach(y),m=E(r),v=$(r,"DIV",{class:!0});var w=g(v);T=$(w,"DIV",{class:!0});var x=g(T);N(S.$$.fragment,x),R=E(x),L=$(x,"DIV",{style:!0});var I=g(L);N(M.$$.fragment,I),x.forEach(y),F=E(w),K&&K.l(w),w.forEach(y),r.forEach(y),X=E(t),N(_.$$.fragment,t),this.h()},h(){b(a,"class",r="mdi mdi-"+t[0].icon+" svelte-f4oc4k"),b(s,"class","svelte-f4oc4k"),b(c,"class","circle svelte-f4oc4k"),P(c,"border-color",t[4]),b(u,"type","color"),b(u,"class","svelte-f4oc4k"),b(i,"class","svelte-f4oc4k"),b(d,"type","text"),b(d,"class","svelte-f4oc4k"),P(n,"background-color",t[1]),P(n,"color",t[4]),b(n,"class","svelte-f4oc4k"),P(L,"display","contents"),P(L,"--accentColor","#ff3030"),b(T,"class","buttons svelte-f4oc4k"),b(v,"class","mainArea svelte-f4oc4k"),b(e,"class","svelte-f4oc4k")},m(r,h){w(r,e,h),x(e,n),x(n,s),x(s,a),x(n,l),x(n,i),x(i,c),x(i,o),x(i,u),t[12](u),H(u,t[0].color),x(n,f),x(n,d),H(d,t[0].name),x(e,m),x(e,v),x(v,T),D(S,T,null),x(T,R),x(T,L),D(M,L,null),x(v,F),K&&K.m(v,null),w(r,X,h),D(_,r,h),G=!0,Y||(J=[I(s,"click",t[11]),I(u,"input",t[13]),I(i,"click",t[7]),I(d,"input",t[14])],Y=!0)},p(t,[e]){(!G||1&e&&r!==(r="mdi mdi-"+t[0].icon+" svelte-f4oc4k"))&&b(a,"class",r),(!G||16&e)&&P(c,"border-color",t[4]),1&e&&H(u,t[0].color),1&e&&d.value!==t[0].name&&H(d,t[0].name),(!G||2&e)&&P(n,"background-color",t[1]),(!G||16&e)&&P(n,"color",t[4]);const s={};262144&e&&(s.$$scope={dirty:e,ctx:t}),S.$set(s);const l={};262144&e&&(l.$$scope={dirty:e,ctx:t}),M.$set(l),null!==t[5]?K?(K.p(t,e),32&e&&O(K,1)):(K=Ss(t),K.c(),O(K,1),K.m(v,null)):K&&(z(),C(K,1,1,(()=>{K=null})),B());const i={};262144&e&&(i.$$scope={dirty:e,ctx:t}),!W&&8&e&&(W=!0,i.open=t[3],U((()=>W=!1))),_.$set(i)},i(t){G||(O(S.$$.fragment,t),O(M.$$.fragment,t),O(K),O(_.$$.fragment,t),G=!0)},o(t){C(S.$$.fragment,t),C(M.$$.fragment,t),C(K),C(_.$$.fragment,t),G=!1},d(n){n&&y(e),t[12](null),A(S),A(M),K&&K.d(),n&&y(X),A(_,n),Y=!1,q(J)}}}function Ps(t,e,n){let s,a,r;const l=L();var{campaign:i=M("campaign")}=e,{button:c}=e;let o,u=!1;return t.$$set=t=>{"campaign"in t&&n(10,i=t.campaign),"button"in t&&n(0,c=t.button)},t.$$.update=()=>{1&t.$$.dirty&&n(1,s=c.color),2&t.$$.dirty&&n(4,a=fs(s)),1&t.$$.dirty&&n(5,r=function(t){let e=t.getDefinition();return e.editor?e.editor:e.editorForm?xs:null}(c))},[c,s,o,u,a,r,function({detail:t}){n(0,c.icon=t,c),n(3,u=!1)},function(){o.click()},function(){l("update",c),l("changed")},function(){confirm("Are you sure you want to remove this button?")&&(l("remove",c),l("changed"))},i,()=>n(3,u=!0),function(t){V[t?"unshift":"push"]((()=>{o=t,n(2,o)}))},function(){c.color=this.value,n(0,c)},function(){c.name=this.value,n(0,c)},function(t){u=t,n(3,u)}]}class Ds extends o{constructor(t){super(),u(this,t,Ps,Ns,f,{campaign:10,button:0})}}function Os(t){let e,n;return e=new Ds({props:{button:t[0]}}),e.$on("changed",t[8]),e.$on("update",t[10]),e.$on("remove",t[11]),{c(){k(e.$$.fragment)},l(t){N(e.$$.fragment,t)},m(t,s){D(e,t,s),n=!0},p(t,n){const s={};1&n&&(s.button=t[0]),e.$set(s)},i(t){n||(O(e.$$.fragment,t),n=!0)},o(t){C(e.$$.fragment,t),n=!1},d(t){A(e,t)}}}function Cs(t){let e,n,s;var a=t[4];function r(t){return{props:{button:t[0]}}}return a&&(e=new a(r(t))),{c(){e&&k(e.$$.fragment),n=m()},l(t){e&&N(e.$$.fragment,t),n=m()},m(t,a){e&&D(e,t,a),w(t,n,a),s=!0},p(t,s){const l={};if(1&s&&(l.button=t[0]),a!==(a=t[4])){if(e){z();const t=e;C(t.$$.fragment,1,0,(()=>{A(t,1)})),B()}a?(e=new a(r(t)),k(e.$$.fragment),O(e.$$.fragment,1),D(e,n.parentNode,n)):e=null}else a&&e.$set(l)},i(t){s||(e&&O(e.$$.fragment,t),s=!0)},o(t){e&&C(e.$$.fragment,t),s=!1},d(t){t&&y(n),e&&A(e,t)}}}function As(t){let e,n,s,a,r,l,i,c,o,u,f,m,S,H,R,M,L,F,X,_=t[0].name+"";var W=t[5];function G(t){return{props:{button:t[0]}}}function Y(e){t[12](e)}W&&(s=new W(G(t)));let J={noPadding:!0,min:!0,$$slots:{default:[Os]},$$scope:{ctx:t}};function K(e){t[13](e)}void 0!==t[2]&&(J.open=t[2]),m=new Dt({props:J}),V.push((()=>j(m,"open",Y)));let Q={$$slots:{default:[Cs]},$$scope:{ctx:t}};return void 0!==t[3]&&(Q.open=t[3]),R=new Dt({props:Q}),V.push((()=>j(R,"open",K))),{c(){e=h("div"),n=h("div"),s&&k(s.$$.fragment),a=p(),r=h("div"),l=h("p"),i=h("span"),o=p(),u=d(_),f=p(),k(m.$$.fragment),H=p(),k(R.$$.fragment),this.h()},l(t){e=$(t,"DIV",{class:!0,style:!0});var c=g(e);n=$(c,"DIV",{class:!0});var h=g(n);s&&N(s.$$.fragment,h),h.forEach(y),a=E(c),r=$(c,"DIV",{class:!0});var d=g(r);l=$(d,"P",{class:!0});var p=g(l);i=$(p,"SPAN",{class:!0}),g(i).forEach(y),o=E(p),u=v(p,_),p.forEach(y),d.forEach(y),c.forEach(y),f=E(t),N(m.$$.fragment,t),H=E(t),N(R.$$.fragment,t),this.h()},h(){b(n,"class","background svelte-1d5mqyc"),b(i,"class",c="mdi mdi-"+t[1].icon+" svelte-1d5mqyc"),b(l,"class","svelte-1d5mqyc"),b(r,"class","foreground svelte-1d5mqyc"),b(e,"class","button svelte-1d5mqyc"),P(e,"color",t[6])},m(c,h){w(c,e,h),x(e,n),s&&D(s,n,null),x(e,a),x(e,r),x(r,l),x(l,i),x(l,o),x(l,u),w(c,f,h),D(m,c,h),w(c,H,h),D(R,c,h),L=!0,F||(X=[I(e,"click",t[7]),at(hs.call(null,e,t[9]))],F=!0)},p(t,[a]){const r={};if(1&a&&(r.button=t[0]),W!==(W=t[5])){if(s){z();const t=s;C(t.$$.fragment,1,0,(()=>{A(t,1)})),B()}W?(s=new W(G(t)),k(s.$$.fragment),O(s.$$.fragment,1),D(s,n,null)):s=null}else W&&s.$set(r);(!L||2&a&&c!==(c="mdi mdi-"+t[1].icon+" svelte-1d5mqyc"))&&b(i,"class",c),(!L||1&a)&&_!==(_=t[0].name+"")&&T(u,_),(!L||64&a)&&P(e,"color",t[6]);const l={};32769&a&&(l.$$scope={dirty:a,ctx:t}),!S&&4&a&&(S=!0,l.open=t[2],U((()=>S=!1))),m.$set(l);const o={};32785&a&&(o.$$scope={dirty:a,ctx:t}),!M&&8&a&&(M=!0,o.open=t[3],U((()=>M=!1))),R.$set(o)},i(t){L||(s&&O(s.$$.fragment,t),O(m.$$.fragment,t),O(R.$$.fragment,t),L=!0)},o(t){s&&C(s.$$.fragment,t),C(m.$$.fragment,t),C(R.$$.fragment,t),L=!1},d(t){t&&y(e),s&&A(s),t&&y(f),A(m,t),t&&y(H),A(R,t),F=!1,q(X)}}}function Vs(t,e,n){let s,a,r;const l=L();var{button:i}=e;let c=!1,o=!1,u=null;return t.$$set=t=>{"button"in t&&n(0,i=t.button)},t.$$.update=()=>{1&t.$$.dirty&&n(1,s=i.getDefinition()),3&t.$$.dirty&&n(5,a=s.customButtonFace&&i.useCustomPlate?s.customButtonFace:ms),1&t.$$.dirty&&n(6,r=fs(i.color))},[i,s,c,o,u,a,r,function(){switch(i.getBehavior()){case Xn.ACTION:i.executeAction();break;case Xn.POPUP:n(4,u=i.getDefinition().popupContent);break;case Xn.SPECIAL:l("special",i)}},function(){n(2,c=!1)},function(){n(2,c=!0)},function(e){rt(t,e)},function(e){rt(t,e)},function(t){c=t,n(2,c)},function(t){o=t,n(3,o)}]}class zs extends o{constructor(t){super(),u(this,t,Vs,As,f,{button:0})}}function Bs(t={}){if("object"!=typeof t||null===t)throw new Error("Expected an object");return c(i({id:dt(),type:"reference",name:"New button",icon:"gesture-tap",color:"#ffffff",useCustomPlate:!1,state:{}},t),{getDefinition(){let t=Object.values(ss).find((t=>t.type===this.type));return null!=t?t:null},getBehavior(){return this.getDefinition().behavior},getState(){return this.state},executeAction(){this.getDefinition().action(this.getState(),this)}})}Bs.fromDefinition=function(t){let e=Bs({icon:t.icon,color:t.color,type:t.type,state:t.defaultState,name:t.name});return t.defaultState&&(e.state=t.defaultState),e};class Hs{constructor(t,e){this.id=t,this.buttons=function(t,e){for(let n=0;n<t.length;n++)t[n]=e(t[n],n,t);return t}(e,(t=>Bs(t))),this.readable=lt([],(t=>{this.readableSet=t,this.readableSet(this.buttons)}))}refresh(){this.readableSet(this.buttons)}addFromDefinition(t){let e=Bs({icon:t.icon,color:t.color,type:t.type,state:t.defaultState,name:t.name});return t.defaultState&&(e.state=t.defaultState),this.buttons.push(e),this.refresh(),e}removeButton(t){let e=this.buttons.indexOf(t);-1!=e&&(this.buttons.splice(e,1),this.refresh())}updateButton(t){let e=this.buttons.indexOf(t);-1!=e&&(this.buttons[e]=t,this.refresh())}subscribe(t,e){return this.readable.subscribe(t)}}function Rs(t,e,n){const s=t.slice();return s[14]=e[n],s}function qs(t){let e,n,s,a;return{c(){e=h("button"),n=h("span"),this.h()},l(t){e=$(t,"BUTTON",{class:!0});var s=g(e);n=$(s,"SPAN",{class:!0}),g(n).forEach(y),s.forEach(y),this.h()},h(){b(n,"class","mdi mdi-arrow-left"),b(e,"class","svelte-1eidxpn")},m(r,l){w(r,e,l),x(e,n),s||(a=I(e,"click",t[4]),s=!0)},p:R,d(t){t&&y(e),s=!1,a()}}}function Ms(t,e){let n,s,a;return s=new zs({props:{button:e[14]}}),s.$on("update",e[6]),s.$on("remove",e[7]),s.$on("special",e[8]),{key:t,first:null,c(){n=m(),k(s.$$.fragment),this.h()},l(t){n=m(),N(s.$$.fragment,t),this.h()},h(){this.first=n},m(t,e){w(t,n,e),D(s,t,e),a=!0},p(t,n){e=t;const a={};8&n&&(a.button=e[14]),s.$set(a)},i(t){a||(O(s.$$.fragment,t),a=!0)},o(t){C(s.$$.fragment,t),a=!1},d(t){t&&y(n),A(s,t)}}}function js(t){let e,n;return e=new us({}),e.$on("select",t[5]),{c(){k(e.$$.fragment)},l(t){N(e.$$.fragment,t)},m(t,s){D(e,t,s),n=!0},p:R,i(t){n||(O(e.$$.fragment,t),n=!0)},o(t){C(e.$$.fragment,t),n=!1},d(t){A(e,t)}}}function Us(t){let e,n,s,a,r,l,i,c,o,u,f,d=[],m=new Map,v="root"!==t[2].id&&qs(t),T=t[3];const S=t=>t[14].id;for(let h=0;h<T.length;h+=1){let e=Rs(t,T,h),n=S(e);m.set(n,d[h]=Ms(n,e))}function P(e){t[12](e)}let H={$$slots:{default:[js]},$$scope:{ctx:t}};return void 0!==t[1]&&(H.open=t[1]),i=new Dt({props:H}),V.push((()=>j(i,"open",P))),{c(){e=h("section"),v&&v.c(),n=p();for(let t=0;t<d.length;t+=1)d[t].c();s=p(),a=h("button"),r=h("span"),l=p(),k(i.$$.fragment),this.h()},l(t){e=$(t,"SECTION",{class:!0});var c=g(e);v&&v.l(c),n=E(c);for(let e=0;e<d.length;e+=1)d[e].l(c);s=E(c),a=$(c,"BUTTON",{class:!0});var o=g(a);r=$(o,"SPAN",{class:!0}),g(r).forEach(y),o.forEach(y),c.forEach(y),l=E(t),N(i.$$.fragment,t),this.h()},h(){b(r,"class","mdi mdi-plus"),b(a,"class","svelte-1eidxpn"),b(e,"class","svelte-1eidxpn")},m(c,h){w(c,e,h),v&&v.m(e,null),x(e,n);for(let t=0;t<d.length;t+=1)d[t].m(e,null);x(e,s),x(e,a),x(a,r),t[11](e),w(c,l,h),D(i,c,h),o=!0,u||(f=I(a,"click",t[10]),u=!0)},p(t,[a]){"root"!==t[2].id?v?v.p(t,a):(v=qs(t),v.c(),v.m(e,n)):v&&(v.d(1),v=null),456&a&&(T=t[3],z(),d=Z(d,a,S,1,t,T,m,e,tt,Ms,s,Rs),B());const r={};131072&a&&(r.$$scope={dirty:a,ctx:t}),!c&&2&a&&(c=!0,r.open=t[1],U((()=>c=!1))),i.$set(r)},i(t){if(!o){for(let t=0;t<T.length;t+=1)O(d[t]);O(i.$$.fragment,t),o=!0}},o(t){for(let e=0;e<d.length;e+=1)C(d[e]);C(i.$$.fragment,t),o=!1},d(n){n&&y(e),v&&v.d();for(let t=0;t<d.length;t+=1)d[t].d();t[11](null),n&&y(l),A(i,n),u=!1,f()}}}function Ls(t,e,n){let s,a=R,r=()=>(a(),a=F(o,(t=>n(3,s=t))),o);t.$$.on_destroy.push((()=>a()));var{campaign:l=M("campaign")}=e;let i,c=!1,o=l.buttonPad.getRootCollection();r();let u=[];return t.$$set=t=>{"campaign"in t&&n(9,l=t.campaign)},[i,c,o,s,function(){u.length>0&&(i.animate([{transform:"translateX(0px)",opacity:1},{transform:"translateX(32px)",opacity:0},{transform:"translateX(-32px)",opacity:0},{transform:"translateX(0px)",opacity:1}],{duration:400,easing:"cubic-bezier(0.4, 0.0, 0.2, 1)"}),setTimeout((()=>{r(n(2,o=u.pop()))}),150))},function({detail:t}){o.addFromDefinition(t),l.refresh(),n(1,c=!1)},function({detail:t}){o.updateButton(t),l.refresh()},function({detail:t}){o.removeButton(t),l.refresh()},function({detail:t}){"folder"===t.type&&(i.animate([{transform:"translateX(0px)",opacity:1},{transform:"translateX(-32px)",opacity:0},{transform:"translateX(32px)",opacity:0},{transform:"translateX(0px)",opacity:1}],{duration:400,easing:"cubic-bezier(0.4, 0.0, 0.2, 1)"}),setTimeout((()=>{u.push(o),r(n(2,o=new Hs("id",t.state.buttons)))}),150))},l,()=>n(1,c=!0),function(t){V[t?"unshift":"push"]((()=>{i=t,n(0,i)}))},function(t){c=t,n(1,c)}]}class Fs extends o{constructor(t){super(),u(this,t,Ls,Us,f,{campaign:9})}}const Xs={default:{id:"default",title:"DM Screen",icon:"view-dashboard-outline",component:class extends o{constructor(t){super(),u(this,t,bn,En,f,{campaign:0})}}},encounterBuilder:{id:"encounterBuilder",title:"Encounter builder",icon:"sword-cross",component:class extends o{constructor(t){super(),u(this,t,Fn,Ln,f,{campaign:3})}}},settingsView:{id:"settingsView",title:"Settings",icon:"cog",component:class extends o{constructor(t){super(),u(this,t,Yn,Gn,f,{campaign:0})}}}};const _s=new Map;function Ws(t){var e;const n=Bt(`campaign_${t}`,te);n.update((t=>i(i({},te),t))),n.set(function(t){let e=_s.entries(),{value:n}=e.next();for(;void 0!==n;){let[s,a]=n;t.version<s&&(a(t),t.version=s),n=e.next().value}return t}(n.get())),(null==(e=n.get())?void 0:e.dataset)||(n.get().dataset=Ht.get(),n.refresh());const s={campaignStore:n,refresh(){n.refresh()},subscribe(t){return n.subscribe((e=>{t(this)}))},update(t){n.update(t)},get:()=>n.get(),optimizedForTablet(){return this.get().settings.optimizeTablet}};return s.screens=function(t){const{campaignStore:e}=t;return{get:()=>e.get().screens,getScreenById(t){return this.get().find((e=>e.id===t))},getOpenScreenId:()=>e.get().currentScreenId,getOpenScreen(){return this.get().find((t=>t.id===this.getOpenScreenId()))},newScreen(){let t=i({},Jt);t.id=dt(),t.name="New screen",this.get().push(t),e.refresh()},openScreen(t){"object"==typeof t&&(t=t.id),e.get().currentScreenId=t,e.refresh()},deleteScreen(t){let n=this.get(),s=n.indexOf(t);if(s<0)return"notAScreen";this.openScreen("root"),n.splice(s,1),e.refresh()},addItemToScreen(t,n="Pinned item",s,a=null){let r=c(i({},Zt),{id:dt(),title:n,type:s,data:a});t.items.push(r),e.refresh()},addItemToCurrentScreen(t="Pinned item",e,n=null){this.addItemToScreen(this.getOpenScreen(),t,e,n)},removeItemFromScreen(t,n){let s=t.items.indexOf(n);t.items.splice(s,1),e.refresh()},renameCurrentScreen(t){this.getOpenScreen().name=t,e.refresh()},moveUp(t){let n=this.getOpenScreen().items,s=n.sort((e=>e.id===t.id?-1:1)).map(((t,e)=>(t.index=n.length-e,t)));this.getOpenScreen().items=s,e.refresh()},togglePin(e){e.pinned=!e.pinned,t.refresh()},moveItemTo(t,n){"string"==typeof n&&(n=this.getScreenById(n)),this.removeItemFromScreen(this.getOpenScreen(),t),this.addItemToScreen(n,t.title,t.type,t.data),e.refresh()}}}(s),s.party=function(t){const{campaignStore:e}=t;return{get:()=>e.get().partyMembers,getById(t){return this.get().find((e=>e.id===t))||null},addMember(){let e=i({},ee);e.id=dt(),this.get().push(e),t.refresh()},removeMember(e){let n=this.get().indexOf(e);if(n<0)return"noPartyMember";this.get().splice(n,1),t.refresh()},getXPThreshHolds(){let t=this.get(),e={easy:0,medium:0,hard:0,deadly:0};for(let{level:n}of t){if(n<1||n>20)continue;let t=n-1,[s,a,r,l]=ne[t];e.easy+=s,e.medium+=a,e.hard+=r,e.deadly+=l}return e},getDailyXP(){return this.get().map((t=>se[t.level])).reduce(((t,e)=>t+e),0)}}}(s),s.initiative=function(t){const{campaignStore:e}=t;return{get:()=>e.get().initiative,getCombatStarted(){return this.get().length>0},getRound:()=>e.get().initiativeRound,getPreviousInitiativeIndex(){return this.getMappedIndex(this.getCurrentInitiativeIndex()-1)},getCurrentInitiativeIndex:()=>e.get().currentInitiativeIndex,getNextInitiativeIndex(){return this.getMappedIndex(this.getCurrentInitiativeIndex()+1)},getPreviousEntry(){let t=this.getPreviousInitiativeIndex();return this.getSortedInitiative()[t]},getCurrentEntry(){let t=this.getCurrentInitiativeIndex();return this.getSortedInitiative()[t]},getNextEntry(){let t=this.getNextInitiativeIndex();return this.getSortedInitiative()[t]},getInitiativeOverview(){return[this.getPreviousEntry(),this.getCurrentEntry(),this.getNextEntry()]},getSortedInitiative(){return this.get().sort(((t,e)=>e.initiative-t.initiative))},getMappedIndex(t){return function(t,e,n){let s=t%(n+1);return s<0&&(s=n+1+s),s+e}(t,0,this.get().length-1)},previousInitiative(){let n=this.getPreviousInitiativeIndex(),s=e.get();s.currentInitiativeIndex=n,n===this.get().length-1&&s.initiativeRound--,t.refresh()},nextInitiative(){let n=this.getNextInitiativeIndex(),s=e.get();s.currentInitiativeIndex=n,0===n&&s.initiativeRound++,t.refresh()},addEntryToInitiative(e){this.get().push(e),t.refresh()},addManualEntry(){let t=re();this.addEntryToInitiative(t)},addPartyMember(t){let e=re();e.type="partyMember",e.name=t.name,e.data=t.id,this.addEntryToInitiative(e)},addPartyToInitiative(){let e=t.party.get();for(let t of e)this.addPartyMember(t)},addMonster(t){let e=re();e.type="monster",e.name=t.name,e.data=pt(t),e.currentHealth=t.hp.average,e.maxHealth=t.hp.average,this.addEntryToInitiative(e)},removeEntry(n){let s=this.get().indexOf(n);if(s<0)return"noEntry";let a=e.get().currentInitiativeIndex;var r,l,i;e.get().currentInitiativeIndex=(r=0,l=a,i=this.get().length-1,l<r?r:l>i?i:l),this.get().splice(s,1),t.refresh()}}}(s),s.mainManager=function(t){const{campaignStore:e}=t;return{get(){let t=this.getCurrentId(),e=this.getList().find((e=>e.id===t));return null!=e?e:Xs.default},getCurrentId:()=>e.get().currentManager,getList(){let e=Object.values(Xs);return t.optimizedForTablet()&&(e[0]={id:"buttonPad",title:"Button Pad",icon:"gesture-tap-button",component:Fs}),console.log(e),e},setManager(t){e.get().currentManager=t,e.refresh()},showSourcePage(t,e){this.setManager("bookView"),this.get().openSource=t,this.get().openPage=e}}}(s),s.buttonPad=function(t){return{getRootCollection:()=>new Hs("root",t.get().buttons)}}(s),s}_s.set(1.1,(t=>{var e;t.settings=t.settings||{optimizeTablet:!1},t.buttons=null!=(e=t.buttons)?e:[]}));function Gs(t,e,n){const s=t.slice();return s[9]=e[n],s}function Ys(t){let e,n,s,a,r=t[2],l=[];for(let i=0;i<r.length;i+=1)l[i]=Js(Gs(t,r,i));return{c(){e=h("div");for(let t=0;t<l.length;t+=1)l[t].c();this.h()},l(t){e=$(t,"DIV",{class:!0});var n=g(e);for(let e=0;e<l.length;e+=1)l[e].l(n);n.forEach(y),this.h()},h(){b(e,"class","menu svelte-2yazq0")},m(r,i){w(r,e,i);for(let t=0;t<l.length;t+=1)l[t].m(e,null);s||(a=at(n=it.call(null,e,t[5])),s=!0)},p(t,n){if(76&n){let s;for(r=t[2],s=0;s<r.length;s+=1){const a=Gs(t,r,s);l[s]?l[s].p(a,n):(l[s]=Js(a),l[s].c(),l[s].m(e,null))}for(;s<l.length;s+=1)l[s].d(1);l.length=r.length}},d(t){t&&y(e),S(l,t),s=!1,a()}}}function Js(t){let e,n,s,a,r,l,i,c,o,u,f=t[9].title+"";function m(){return t[8](t[9])}return{c(){e=h("div"),n=h("p"),s=h("span"),r=p(),l=d(f),i=p(),this.h()},l(t){e=$(t,"DIV",{class:!0});var a=g(e);n=$(a,"P",{class:!0});var c=g(n);s=$(c,"SPAN",{class:!0}),g(s).forEach(y),r=E(c),l=v(c,f),c.forEach(y),i=E(a),a.forEach(y),this.h()},h(){b(s,"class",a="mdi mdi-"+t[9].icon+" svelte-2yazq0"),b(n,"class","svelte-2yazq0"),b(e,"class",c="menuItem "+(t[9].id===t[3]&&"current")+" svelte-2yazq0")},m(t,a){w(t,e,a),x(e,n),x(n,s),x(n,r),x(n,l),x(e,i),o||(u=I(e,"click",m),o=!0)},p(n,r){t=n,4&r&&a!==(a="mdi mdi-"+t[9].icon+" svelte-2yazq0")&&b(s,"class",a),4&r&&f!==(f=t[9].title+"")&&T(l,f),12&r&&c!==(c="menuItem "+(t[9].id===t[3]&&"current")+" svelte-2yazq0")&&b(e,"class",c)},d(t){t&&y(e),o=!1,u()}}}function Ks(t){let e,n,s,a,r,l,i=t[1]&&Ys(t);return{c(){e=h("button"),n=h("span"),s=p(),i&&i.c(),a=m(),this.h()},l(t){e=$(t,"BUTTON",{class:!0});var r=g(e);n=$(r,"SPAN",{class:!0}),g(n).forEach(y),r.forEach(y),s=E(t),i&&i.l(t),a=m(),this.h()},h(){b(n,"class","mdi mdi-menu svelte-2yazq0"),b(e,"class","navButton svelte-2yazq0")},m(c,o){w(c,e,o),x(e,n),w(c,s,o),i&&i.m(c,o),w(c,a,o),r||(l=I(e,"click",t[4]),r=!0)},p(t,[e]){t[1]?i?i.p(t,e):(i=Ys(t),i.c(),i.m(a.parentNode,a)):i&&(i.d(1),i=null)},i:R,o:R,d(t){t&&y(e),t&&y(s),i&&i.d(t),t&&y(a),r=!1,l()}}}function Qs(t,e,n){let s,a,r,l=R,i=()=>(l(),l=F(c,(t=>n(7,r=t))),c);t.$$.on_destroy.push((()=>l()));var{campaign:c}=e;i();var o=!1;function u(t){c.mainManager.setManager(t)}return t.$$set=t=>{"campaign"in t&&i(n(0,c=t.campaign))},t.$$.update=()=>{128&t.$$.dirty&&n(2,s=r.mainManager.getList()),128&t.$$.dirty&&n(3,a=r.mainManager.getCurrentId())},[c,o,s,a,function(){setTimeout((()=>{n(1,o=!0)}),0)},function(){n(1,o=!1)},u,r,t=>u(t.id)]}class Zs extends o{constructor(t){super(),u(this,t,Qs,Ks,f,{campaign:0})}}function ta(t){let e,n,s,a,r,l,i,c,o,u,f,m,S;return{c(){e=h("h1"),n=d(t[1]),a=p(),r=h("p"),l=d(t[2]),i=p(),c=h("input"),o=p(),u=h("button"),f=d("roll"),this.h()},l(s){e=$(s,"H1",{class:!0});var h=g(e);n=v(h,t[1]),h.forEach(y),a=E(s),r=$(s,"P",{class:!0});var d=g(r);l=v(d,t[2]),d.forEach(y),i=E(s),c=$(s,"INPUT",{class:!0}),o=E(s),u=$(s,"BUTTON",{class:!0});var p=g(u);f=v(p,"roll"),p.forEach(y),this.h()},h(){b(e,"class",s=Q(t[4])+" svelte-16axwwy"),b(r,"class","svelte-16axwwy"),b(c,"class","svelte-16axwwy"),b(u,"class","svelte-16axwwy")},m(s,h){w(s,e,h),x(e,n),w(s,a,h),w(s,r,h),x(r,l),w(s,i,h),w(s,c,h),t[13](c),H(c,t[0]),w(s,o,h),w(s,u,h),x(u,f),m||(S=[I(c,"input",t[14]),I(c,"keydown",t[6]),I(u,"click",t[5])],m=!0)},p(t,[a]){2&a&&T(n,t[1]),16&a&&s!==(s=Q(t[4])+" svelte-16axwwy")&&b(e,"class",s),4&a&&T(l,t[2]),1&a&&c.value!==t[0]&&H(c,t[0])},i:R,o:R,d(n){n&&y(e),n&&y(a),n&&y(r),n&&y(i),n&&y(c),t[13](null),n&&y(o),n&&y(u),m=!1,q(S)}}}function ea(t,e,n){let s,a,r;var l,i,c,{expression:o=""}=e,{doRoll:u=!1}=e,{doFocus:f=!1}=e,h="?",d="";function p(){let t=Rt(o);t?(n(1,h=String(t.result)),n(2,d=t.resultExpression),n(9,i=t.minResult),n(10,c=t.maxResult)):(n(1,h="?"),n(2,d=""))}return ct((()=>{f&&l.focus()})),p(),t.$$set=t=>{"expression"in t&&n(0,o=t.expression),"doRoll"in t&&n(7,u=t.doRoll),"doFocus"in t&&n(8,f=t.doFocus)},t.$$.update=()=>{514&t.$$.dirty&&n(11,s=h===i),1026&t.$$.dirty&&n(12,a=h===c),6144&t.$$.dirty&&n(4,r=`${s?"natOne":""} ${a?"natTwenty":""}`),128&t.$$.dirty&&u&&(p(),n(7,u=!1))},[o,h,d,l,r,p,function(t){let e=["d","+","-","/","*","^","Backspace","a"];"Enter"===t.key?p():isNaN(t.key)&&!e.includes(t.key)&&t.preventDefault()},u,f,i,c,s,a,function(t){V[t?"unshift":"push"]((()=>{n(3,l=t)}))},function(){o=this.value,n(0,o)}]}class na extends o{constructor(t){super(),u(this,t,ea,ta,f,{expression:0,doRoll:7,doFocus:8})}}function sa(t){let e,n,s,a,r,l;return n=new na({props:{doFocus:!0}}),{c(){e=h("div"),k(n.$$.fragment),this.h()},l(t){e=$(t,"DIV",{class:!0});var s=g(e);N(n.$$.fragment,s),s.forEach(y),this.h()},h(){b(e,"class","diceDrawer svelte-4m5zue")},m(i,c){w(i,e,c),D(n,e,null),a=!0,r||(l=at(s=it.call(null,e,t[2])),r=!0)},p:R,i(t){a||(O(n.$$.fragment,t),a=!0)},o(t){C(n.$$.fragment,t),a=!1},d(t){t&&y(e),A(n),r=!1,l()}}}function aa(t){let e,n,s,a,r,l,i,c=t[0]&&sa(t);return{c(){e=h("button"),n=h("span"),s=p(),c&&c.c(),a=m(),this.h()},l(t){e=$(t,"BUTTON",{class:!0});var r=g(e);n=$(r,"SPAN",{class:!0}),g(n).forEach(y),r.forEach(y),s=E(t),c&&c.l(t),a=m(),this.h()},h(){b(n,"class","mdi mdi-dice-d20 svelte-4m5zue"),b(e,"class","svelte-4m5zue")},m(o,u){w(o,e,u),x(e,n),w(o,s,u),c&&c.m(o,u),w(o,a,u),r=!0,l||(i=I(e,"click",t[1]),l=!0)},p(t,[e]){t[0]?c?(c.p(t,e),1&e&&O(c,1)):(c=sa(t),c.c(),O(c,1),c.m(a.parentNode,a)):c&&(z(),C(c,1,1,(()=>{c=null})),B())},i(t){r||(O(c),r=!0)},o(t){C(c),r=!1},d(t){t&&y(e),t&&y(s),c&&c.d(t),t&&y(a),l=!1,i()}}}function ra(t,e,n){var s=!1,a=!0;return[s,function(){n(0,s=!0),a=!0},function(){a?a=!1:n(0,s=!1)}]}class la extends o{constructor(t){super(),u(this,t,ra,aa,f,{})}}function ia(t,e,n){const s=t.slice();return s[12]=e[n],s[13]=e,s[14]=n,s}function ca(t){let e,n,s,a,r,l,i,c,o,u,f,d,m,v,T,S;function k(){t[8].call(s,t[13],t[14])}function N(){t[9].call(l,t[13],t[14])}function P(){t[10].call(o,t[13],t[14])}function D(){return t[11](t[12])}return{c(){e=h("tr"),n=h("td"),s=h("input"),a=p(),r=h("td"),l=h("input"),i=p(),c=h("td"),o=h("input"),u=p(),f=h("td"),d=h("button"),m=h("span"),v=p(),this.h()},l(t){e=$(t,"TR",{});var h=g(e);n=$(h,"TD",{class:!0});var p=g(n);s=$(p,"INPUT",{type:!0,spellcheck:!0,class:!0}),p.forEach(y),a=E(h),r=$(h,"TD",{class:!0});var b=g(r);l=$(b,"INPUT",{type:!0,min:!0,max:!0,class:!0}),b.forEach(y),i=E(h),c=$(h,"TD",{class:!0});var w=g(c);o=$(w,"INPUT",{type:!0,min:!0,class:!0}),w.forEach(y),u=E(h),f=$(h,"TD",{class:!0});var x=g(f);d=$(x,"BUTTON",{class:!0});var I=g(d);m=$(I,"SPAN",{class:!0}),g(m).forEach(y),I.forEach(y),x.forEach(y),v=E(h),h.forEach(y),this.h()},h(){b(s,"type","text"),b(s,"spellcheck","false"),b(s,"class","svelte-57itb8"),b(n,"class","name svelte-57itb8"),b(l,"type","number"),b(l,"min","1"),b(l,"max","20"),b(l,"class","svelte-57itb8"),b(r,"class","level svelte-57itb8"),b(o,"type","number"),b(o,"min","0"),b(o,"class","svelte-57itb8"),b(c,"class","pp svelte-57itb8"),b(m,"class","mdi mdi-close"),b(d,"class","svelte-57itb8"),b(f,"class","action svelte-57itb8")},m(h,p){w(h,e,p),x(e,n),x(n,s),H(s,t[12].name),x(e,a),x(e,r),x(r,l),H(l,t[12].level),x(e,i),x(e,c),x(c,o),H(o,t[12].pp),x(e,u),x(e,f),x(f,d),x(d,m),x(e,v),T||(S=[I(s,"input",k),I(s,"blur",t[5]),I(l,"input",N),I(l,"blur",t[5]),I(o,"input",P),I(o,"blur",t[5]),I(d,"click",D)],T=!0)},p(e,n){t=e,1&n&&s.value!==t[12].name&&H(s,t[12].name),1&n&&ot(l.value)!==t[12].level&&H(l,t[12].level),1&n&&ot(o.value)!==t[12].pp&&H(o,t[12].pp)},d(t){t&&y(e),T=!1,q(S)}}}function oa(t){let e,n,s,a,r,l,i,c,o,u,f,m,k,N,D,O,C,A,V,z,B,H,q,M,j,U,L,F,X,_,W,G,Y,J,K,Q,Z,tt,et,nt,st,at,rt,lt,it,ct,ot,ut,ft,ht,dt,pt,mt=t[1].easy+"",$t=t[1].medium+"",gt=t[1].hard+"",vt=t[1].deadly+"",yt=t[0],Et=[];for(let h=0;h<yt.length;h+=1)Et[h]=ca(ia(t,yt,h));return{c(){e=h("table"),n=h("tr"),s=h("th"),a=d("Easy"),r=p(),l=h("th"),i=d("Medium"),c=p(),o=h("th"),u=d("Hard"),f=p(),m=h("th"),k=d("Deadly"),N=p(),D=h("tr"),O=h("td"),C=d(mt),A=p(),V=h("td"),z=d($t),B=p(),H=h("td"),q=d(gt),M=p(),j=h("td"),U=d(vt),L=p(),F=h("table"),X=h("colgroup"),_=h("col"),W=p(),G=h("col"),Y=p(),J=h("col"),K=p(),Q=h("tr"),Z=h("th"),tt=d("Name"),et=p(),nt=h("th"),st=d("LvL"),at=p(),rt=h("th"),lt=d("PP"),it=p(),ct=h("th"),ot=p();for(let t=0;t<Et.length;t+=1)Et[t].c();ut=p(),ft=h("button"),ht=d("Add Member"),this.h()},l(t){e=$(t,"TABLE",{class:!0});var h=g(e);n=$(h,"TR",{});var d=g(n);s=$(d,"TH",{class:!0});var p=g(s);a=v(p,"Easy"),p.forEach(y),r=E(d),l=$(d,"TH",{class:!0});var b=g(l);i=v(b,"Medium"),b.forEach(y),c=E(d),o=$(d,"TH",{class:!0});var w=g(o);u=v(w,"Hard"),w.forEach(y),f=E(d),m=$(d,"TH",{class:!0});var x=g(m);k=v(x,"Deadly"),x.forEach(y),d.forEach(y),N=E(h),D=$(h,"TR",{});var I=g(D);O=$(I,"TD",{class:!0});var T=g(O);C=v(T,mt),T.forEach(y),A=E(I),V=$(I,"TD",{class:!0});var S=g(V);z=v(S,$t),S.forEach(y),B=E(I),H=$(I,"TD",{class:!0});var P=g(H);q=v(P,gt),P.forEach(y),M=E(I),j=$(I,"TD",{class:!0});var R=g(j);U=v(R,vt),R.forEach(y),I.forEach(y),h.forEach(y),L=E(t),F=$(t,"TABLE",{class:!0});var dt=g(F);X=$(dt,"COLGROUP",{});var pt=g(X);_=$(pt,"COL",{span:!0,style:!0}),W=E(pt),G=$(pt,"COL",{span:!0,style:!0}),Y=E(pt),J=$(pt,"COL",{span:!0,style:!0}),pt.forEach(y),K=E(dt),Q=$(dt,"TR",{});var yt=g(Q);Z=$(yt,"TH",{class:!0});var bt=g(Z);tt=v(bt,"Name"),bt.forEach(y),et=E(yt),nt=$(yt,"TH",{class:!0});var wt=g(nt);st=v(wt,"LvL"),wt.forEach(y),at=E(yt),rt=$(yt,"TH",{class:!0});var xt=g(rt);lt=v(xt,"PP"),xt.forEach(y),it=E(yt),ct=$(yt,"TH",{class:!0}),g(ct).forEach(y),yt.forEach(y),ot=E(dt);for(let e=0;e<Et.length;e+=1)Et[e].l(dt);dt.forEach(y),ut=E(t),ft=$(t,"BUTTON",{class:!0});var It=g(ft);ht=v(It,"Add Member"),It.forEach(y),this.h()},h(){b(s,"class","svelte-57itb8"),b(l,"class","svelte-57itb8"),b(o,"class","svelte-57itb8"),b(m,"class","svelte-57itb8"),b(O,"class","svelte-57itb8"),b(V,"class","svelte-57itb8"),b(H,"class","svelte-57itb8"),b(j,"class","svelte-57itb8"),b(e,"class","xpThresholds svelte-57itb8"),b(_,"span","1"),P(_,"width","60%"),b(G,"span","1"),P(G,"width","20%"),b(J,"span","1"),P(J,"width","20%"),b(Z,"class","name svelte-57itb8"),b(nt,"class","level svelte-57itb8"),b(rt,"class","pp svelte-57itb8"),b(ct,"class","action svelte-57itb8"),b(F,"class","svelte-57itb8"),b(ft,"class","svelte-57itb8")},m(h,d){w(h,e,d),x(e,n),x(n,s),x(s,a),x(n,r),x(n,l),x(l,i),x(n,c),x(n,o),x(o,u),x(n,f),x(n,m),x(m,k),x(e,N),x(e,D),x(D,O),x(O,C),x(D,A),x(D,V),x(V,z),x(D,B),x(D,H),x(H,q),x(D,M),x(D,j),x(j,U),w(h,L,d),w(h,F,d),x(F,X),x(X,_),x(X,W),x(X,G),x(X,Y),x(X,J),x(F,K),x(F,Q),x(Q,Z),x(Z,tt),x(Q,et),x(Q,nt),x(nt,st),x(Q,at),x(Q,rt),x(rt,lt),x(Q,it),x(Q,ct),x(F,ot);for(let t=0;t<Et.length;t+=1)Et[t].m(F,null);w(h,ut,d),w(h,ft,d),x(ft,ht),dt||(pt=I(ft,"click",t[3]),dt=!0)},p(t,[e]){if(2&e&&mt!==(mt=t[1].easy+"")&&T(C,mt),2&e&&$t!==($t=t[1].medium+"")&&T(z,$t),2&e&&gt!==(gt=t[1].hard+"")&&T(q,gt),2&e&&vt!==(vt=t[1].deadly+"")&&T(U,vt),49&e){let n;for(yt=t[0],n=0;n<yt.length;n+=1){const s=ia(t,yt,n);Et[n]?Et[n].p(s,e):(Et[n]=ca(s),Et[n].c(),Et[n].m(F,null))}for(;n<Et.length;n+=1)Et[n].d(1);Et.length=yt.length}},i:R,o:R,d(t){t&&y(e),t&&y(L),t&&y(F),S(Et,t),t&&y(ut),t&&y(ft),dt=!1,pt()}}}function ua(t,e,n){let s,a,r;var{campaign:l}=e;const{campaignStore:i}=l;function c(t){l.party.removeMember(t)}ut(t,i,(t=>n(7,r=t)));return t.$$set=t=>{"campaign"in t&&n(6,l=t.campaign)},t.$$.update=()=>{192&t.$$.dirty&&n(0,s=l.party.get(r)),192&t.$$.dirty&&n(1,a=l.party.getXPThreshHolds(r))},[s,a,i,function(){l.party.addMember()},c,function(){l.refresh()},l,r,function(t,e){t[e].name=this.value,n(0,s),n(6,l),n(7,r)},function(t,e){t[e].level=ot(this.value),n(0,s),n(6,l),n(7,r)},function(t,e){t[e].pp=ot(this.value),n(0,s),n(6,l),n(7,r)},t=>c(t)]}class fa extends o{constructor(t){super(),u(this,t,ua,oa,f,{campaign:6})}}function ha(t){let e,n,s,a,r,l;return n=new fa({props:{campaign:t[0]}}),{c(){e=h("div"),k(n.$$.fragment),this.h()},l(t){e=$(t,"DIV",{class:!0});var s=g(e);N(n.$$.fragment,s),s.forEach(y),this.h()},h(){b(e,"class","svelte-11y207b")},m(i,c){w(i,e,c),D(n,e,null),a=!0,r||(l=at(s=it.call(null,e,t[3])),r=!0)},p(t,e){const s={};1&e&&(s.campaign=t[0]),n.$set(s)},i(t){a||(O(n.$$.fragment,t),a=!0)},o(t){C(n.$$.fragment,t),a=!1},d(t){t&&y(e),A(n),r=!1,l()}}}function da(t){let e,n,s,a,r,l,i,c=t[1]&&ha(t);return{c(){e=h("button"),n=d("Party Members"),s=p(),c&&c.c(),a=m(),this.h()},l(t){e=$(t,"BUTTON",{class:!0});var r=g(e);n=v(r,"Party Members"),r.forEach(y),s=E(t),c&&c.l(t),a=m(),this.h()},h(){b(e,"class","toolbarButton svelte-11y207b")},m(o,u){w(o,e,u),x(e,n),w(o,s,u),c&&c.m(o,u),w(o,a,u),r=!0,l||(i=I(e,"click",t[2]),l=!0)},p(t,[e]){t[1]?c?(c.p(t,e),2&e&&O(c,1)):(c=ha(t),c.c(),O(c,1),c.m(a.parentNode,a)):c&&(z(),C(c,1,1,(()=>{c=null})),B())},i(t){r||(O(c),r=!0)},o(t){C(c),r=!1},d(t){t&&y(e),t&&y(s),c&&c.d(t),t&&y(a),l=!1,i()}}}function pa(t,e,n){var{campaign:s}=e,a=!1,r=!0;return t.$$set=t=>{"campaign"in t&&n(0,s=t.campaign)},[s,a,function(){n(1,a=!a),a&&(r=!0)},function(){r?r=!1:n(1,a=!1)}]}class ma extends o{constructor(t){super(),u(this,t,pa,da,f,{campaign:0})}}function $a(t){let e,n,s,a,r=t[1]&&ga(),l=t[2]&&va(),i=t[3]&&ya(),c=t[4]&&Ea();return{c(){e=h("div"),r&&r.c(),n=p(),l&&l.c(),s=p(),i&&i.c(),a=p(),c&&c.c(),this.h()},l(t){e=$(t,"DIV",{class:!0});var o=g(e);r&&r.l(o),n=E(o),l&&l.l(o),s=E(o),i&&i.l(o),a=E(o),c&&c.l(o),o.forEach(y),this.h()},h(){b(e,"class","itemsHeader svelte-kocnz6")},m(t,o){w(t,e,o),r&&r.m(e,null),x(e,n),l&&l.m(e,null),x(e,s),i&&i.m(e,null),x(e,a),c&&c.m(e,null)},p(t,o){t[1]?r||(r=ga(),r.c(),r.m(e,n)):r&&(r.d(1),r=null),t[2]?l||(l=va(),l.c(),l.m(e,s)):l&&(l.d(1),l=null),t[3]?i||(i=ya(),i.c(),i.m(e,a)):i&&(i.d(1),i=null),t[4]?c||(c=Ea(),c.c(),c.m(e,null)):c&&(c.d(1),c=null)},d(t){t&&y(e),r&&r.d(),l&&l.d(),i&&i.d(),c&&c.d()}}}function ga(t){let e,n;return{c(){e=h("div"),n=d("Feature"),this.h()},l(t){e=$(t,"DIV",{class:!0});var s=g(e);n=v(s,"Feature"),s.forEach(y),this.h()},h(){b(e,"class","nameWrapper")},m(t,s){w(t,e,s),x(e,n)},d(t){t&&y(e)}}}function va(t){let e;return{c(){e=h("div"),this.h()},l(t){e=$(t,"DIV",{class:!0}),g(e).forEach(y),this.h()},h(){b(e,"class","wrapper centerText svelte-kocnz6")},m(t,n){w(t,e,n)},d(t){t&&y(e)}}}function ya(t){let e;return{c(){e=h("div"),this.h()},l(t){e=$(t,"DIV",{class:!0}),g(e).forEach(y),this.h()},h(){b(e,"class","wrapper centerText svelte-kocnz6")},m(t,n){w(t,e,n)},d(t){t&&y(e)}}}function Ea(t){let e;return{c(){e=h("div"),this.h()},l(t){e=$(t,"DIV",{class:!0}),g(e).forEach(y),this.h()},h(){b(e,"class","wrapper dropdownIndicatorWrapper")},m(t,n){w(t,e,n)},d(t){t&&y(e)}}}function ba(t){let e,n,s,a,r,l,i,c=t[0].name+"";return{c(){e=h("div"),n=h("div"),s=h("p"),a=d(c),r=p(),l=h("p"),i=d(t[7]),this.h()},l(o){e=$(o,"DIV",{class:!0});var u=g(e);n=$(u,"DIV",{class:!0});var f=g(n);s=$(f,"P",{class:!0});var h=g(s);a=v(h,c),h.forEach(y),r=E(f),l=$(f,"P",{class:!0});var d=g(l);i=v(d,t[7]),d.forEach(y),f.forEach(y),u.forEach(y),this.h()},h(){b(s,"class","spellName svelte-kocnz6"),b(l,"class","spellDescription svelte-kocnz6"),b(n,"class","overflowWrapper svelte-kocnz6"),b(e,"class","nameWrapper svelte-kocnz6")},m(t,c){w(t,e,c),x(e,n),x(n,s),x(s,a),x(n,r),x(n,l),x(l,i)},p(t,e){1&e&&c!==(c=t[0].name+"")&&T(a,c),128&e&&T(i,t[7])},d(t){t&&y(e)}}}function wa(t){let e,n,s,a,r,l,i,c,o;return{c(){e=h("div"),n=h("div"),s=h("input"),a=p(),r=h("div"),l=p(),i=h("input"),this.h()},l(t){e=$(t,"DIV",{class:!0});var c=g(e);n=$(c,"DIV",{class:!0});var o=g(n);s=$(o,"INPUT",{type:!0,tabindex:!0,class:!0}),a=E(o),r=$(o,"DIV",{class:!0}),g(r).forEach(y),l=E(o),i=$(o,"INPUT",{type:!0,tabindex:!0,class:!0}),o.forEach(y),c.forEach(y),this.h()},h(){b(s,"type","text"),b(s,"tabindex","-1"),b(s,"class","svelte-kocnz6"),b(r,"class","divider svelte-kocnz6"),b(i,"type","text"),b(i,"tabindex","-1"),b(i,"class","svelte-kocnz6"),b(n,"class","centerWrapper"),b(e,"class","healthManager svelte-kocnz6")},m(u,f){w(u,e,f),x(e,n),x(n,s),H(s,t[0].currentHealth),x(n,a),x(n,r),x(n,l),x(n,i),H(i,t[0].maxHealth),c||(o=[I(s,"keydown",Sa),I(s,"input",t[18]),I(i,"keydown",Sa),I(i,"input",t[19])],c=!0)},p(t,e){1&e&&s.value!==t[0].currentHealth&&H(s,t[0].currentHealth),1&e&&i.value!==t[0].maxHealth&&H(i,t[0].maxHealth)},d(t){t&&y(e),c=!1,q(o)}}}function xa(t){let e;return{c(){e=h("div"),this.h()},l(t){e=$(t,"DIV",{class:!0}),g(e).forEach(y),this.h()},h(){b(e,"class","deathSavesManager svelte-kocnz6")},m(t,n){w(t,e,n)},p:R,d(t){t&&y(e)}}}function Ia(t){let e,n,s,a,r,l,i,c,o,u,f,d,m,v,T=t[6]&&$a(t),S=t[1]&&ba(t);function k(t,e){return"partyMember"===t[0].type?xa:"monster"===t[0].type?wa:void 0}let N=k(t),P=N&&N(t);return{c(){T&&T.c(),e=p(),n=h("div"),s=h("div"),a=h("input"),l=p(),S&&S.c(),i=p(),c=h("div"),P&&P.c(),o=p(),u=h("div"),f=h("button"),d=h("span"),this.h()},l(t){T&&T.l(t),e=E(t),n=$(t,"DIV",{class:!0});var r=g(n);s=$(r,"DIV",{class:!0});var h=g(s);a=$(h,"INPUT",{class:!0,type:!0,tabindex:!0}),h.forEach(y),l=E(r),S&&S.l(r),i=E(r),c=$(r,"DIV",{class:!0});var p=g(c);P&&P.l(p),p.forEach(y),o=E(r),u=$(r,"DIV",{class:!0});var m=g(u);f=$(m,"BUTTON",{class:!0});var v=g(f);d=$(v,"SPAN",{class:!0}),g(d).forEach(y),v.forEach(y),m.forEach(y),r.forEach(y),this.h()},h(){b(a,"class",r=Q(t[8]&&"isCurrent")+" svelte-kocnz6"),b(a,"type","text"),b(a,"tabindex","0"),b(s,"class","initiative wrapper svelte-kocnz6"),b(c,"class","wrapper controlls svelte-kocnz6"),b(d,"class","mdi mdi-close svelte-kocnz6"),b(f,"class","svelte-kocnz6"),b(u,"class","wrapper controlls buttons svelte-kocnz6"),b(n,"class","initiativeItem svelte-kocnz6")},m(r,h){T&&T.m(r,h),w(r,e,h),w(r,n,h),x(n,s),x(s,a),H(a,t[0].initiative),x(n,l),S&&S.m(n,null),x(n,i),x(n,c),P&&P.m(c,null),x(n,o),x(n,u),x(u,f),x(f,d),m||(v=[I(a,"input",t[17]),I(a,"keydown",Sa),I(a,"focus",Ta),I(a,"blur",t[10]),I(f,"click",t[9])],m=!0)},p(t,[s]){t[6]?T?T.p(t,s):(T=$a(t),T.c(),T.m(e.parentNode,e)):T&&(T.d(1),T=null),256&s&&r!==(r=Q(t[8]&&"isCurrent")+" svelte-kocnz6")&&b(a,"class",r),1&s&&a.value!==t[0].initiative&&H(a,t[0].initiative),t[1]?S?S.p(t,s):(S=ba(t),S.c(),S.m(n,i)):S&&(S.d(1),S=null),N===(N=k(t))&&P?P.p(t,s):(P&&P.d(1),P=N&&N(t),P&&(P.c(),P.m(c,null)))},i:R,o:R,d(t){T&&T.d(t),t&&y(e),t&&y(n),S&&S.d(),P&&P.d(),m=!1,q(v)}}}function Ta({target:t}){t.select()}function Sa(t){let{key:e}=t;isNaN(e)&&!["Backspace","ArrowRight","ArrowLeft","Tab"].includes(e)&&t.preventDefault()}function ka(t,e,n){let s,a,r,l,i,c=R;t.$$.on_destroy.push((()=>c()));var{campaign:o=null}=e,{initiativeEntry:u=null}=e,{showName:f=!0}=e,{showHeader:h=!1}=e,{showAddButton:d=!1}=e,{showRemoveButton:p=!1}=e,{showDetails:m=!1}=e,{showPopup:$=!0}=e,{index:g=null}=e,{firstItem:v=!1}=e;return t.$$set=t=>{"campaign"in t&&n(11,o=t.campaign),"initiativeEntry"in t&&n(0,u=t.initiativeEntry),"showName"in t&&n(1,f=t.showName),"showHeader"in t&&n(12,h=t.showHeader),"showAddButton"in t&&n(2,d=t.showAddButton),"showRemoveButton"in t&&n(3,p=t.showRemoveButton),"showDetails"in t&&n(4,m=t.showDetails),"showPopup"in t&&n(13,$=t.showPopup),"index"in t&&n(14,g=t.index),"firstItem"in t&&n(15,v=t.firstItem)},t.$$.update=()=>{2048&t.$$.dirty&&(n(5,s=o.campaignStore),c(),c=F(s,(t=>n(16,i=t)))),53248&t.$$.dirty&&n(6,a=h&&(0===g||v)),65537&t.$$.dirty&&n(7,r=function(t){let e=[];if("partyMember"===t.type){let n=o.party.getById(t.data);e.push(`Level: ${n.level}`),e.push(`Passive Perception: ${n.pp}`)}return e.join(" • ")}(u)),2049&t.$$.dirty&&n(8,l=u===o.initiative.getCurrentEntry())},[u,f,d,p,m,s,a,r,l,function(){o.initiative.removeEntry(u)},function(){queueMicrotask((()=>{o.refresh()}))},o,h,$,g,v,i,function(){u.initiative=this.value,n(0,u)},function(){u.currentHealth=this.value,n(0,u)},function(){u.maxHealth=this.value,n(0,u)}]}class Na extends o{constructor(t){super(),u(this,t,ka,Ia,f,{campaign:11,initiativeEntry:0,showName:1,showHeader:12,showAddButton:2,showRemoveButton:3,showDetails:4,showPopup:13,index:14,firstItem:15})}}function Pa(t,e,n){const s=t.slice();return s[6]=e[n],s[8]=n,s}function Da(t){let e,n;return e=new Na({props:{campaign:t[0],initiativeEntry:t[6],index:t[8]}}),{c(){k(e.$$.fragment)},l(t){N(e.$$.fragment,t)},m(t,s){D(e,t,s),n=!0},p(t,n){const s={};1&n&&(s.campaign=t[0]),4&n&&(s.initiativeEntry=t[6]),e.$set(s)},i(t){n||(O(e.$$.fragment,t),n=!0)},o(t){C(e.$$.fragment,t),n=!1},d(t){A(e,t)}}}function Oa(t){let e,n,s,a,r,l,i,c,o,u,f,m,T,k,N,P=t[2],D=[];for(let h=0;h<P.length;h+=1)D[h]=Da(Pa(t,P,h));const A=t=>C(D[t],1,1,(()=>{D[t]=null}));return{c(){e=h("div"),n=h("header"),s=h("section"),a=h("p"),r=d("Rounds"),l=p(),i=h("input"),c=p();for(let t=0;t<D.length;t+=1)D[t].c();o=p(),u=h("button"),f=h("span"),m=d(" Add party to initiative"),this.h()},l(t){e=$(t,"DIV",{class:!0});var h=g(e);n=$(h,"HEADER",{class:!0});var d=g(n);s=$(d,"SECTION",{class:!0});var p=g(s);a=$(p,"P",{class:!0});var b=g(a);r=v(b,"Rounds"),b.forEach(y),l=E(p),i=$(p,"INPUT",{type:!0,min:!0,class:!0}),p.forEach(y),d.forEach(y),c=E(h);for(let e=0;e<D.length;e+=1)D[e].l(h);o=E(h),u=$(h,"BUTTON",{class:!0});var w=g(u);f=$(w,"SPAN",{class:!0}),g(f).forEach(y),m=v(w," Add party to initiative"),w.forEach(y),h.forEach(y),this.h()},h(){b(a,"class","svelte-1g5lxic"),b(i,"type","number"),b(i,"min","1"),b(i,"class","svelte-1g5lxic"),b(s,"class","svelte-1g5lxic"),b(n,"class","svelte-1g5lxic"),b(f,"class","mdi mdi-account-multiple-plus"),b(u,"class","svelte-1g5lxic"),b(e,"class","initiativeManager")},m(h,d){w(h,e,d),x(e,n),x(n,s),x(s,a),x(a,r),x(s,l),x(s,i),H(i,t[1].initiativeRound),x(e,c);for(let t=0;t<D.length;t+=1)D[t].m(e,null);x(e,o),x(e,u),x(u,f),x(u,m),T=!0,k||(N=[I(i,"input",t[5]),I(i,"blur",(function(){ft(t[0].refresh)&&t[0].refresh.apply(this,arguments)})),I(u,"click",t[4])],k=!0)},p(n,[s]){if(t=n,2&s&&ot(i.value)!==t[1].initiativeRound&&H(i,t[1].initiativeRound),5&s){let n;for(P=t[2],n=0;n<P.length;n+=1){const a=Pa(t,P,n);D[n]?(D[n].p(a,s),O(D[n],1)):(D[n]=Da(a),D[n].c(),O(D[n],1),D[n].m(e,o))}for(z(),n=P.length;n<D.length;n+=1)A(n);B()}},i(t){if(!T){for(let t=0;t<P.length;t+=1)O(D[t]);T=!0}},o(t){D=D.filter(Boolean);for(let e=0;e<D.length;e+=1)C(D[e]);T=!1},d(t){t&&y(e),S(D,t),k=!1,q(N)}}}function Ca(t,e,n){let s,a;var{campaign:r}=e;const{campaignStore:l}=r;return ut(t,l,(t=>n(1,a=t))),t.$$set=t=>{"campaign"in t&&n(0,r=t.campaign)},t.$$.update=()=>{3&t.$$.dirty&&n(2,s=r.initiative.getSortedInitiative(a))},[r,a,s,l,function(){r.initiative.addPartyToInitiative()},function(){a.initiativeRound=ot(this.value),l.set(a)}]}class Aa extends o{constructor(t){super(),u(this,t,Ca,Oa,f,{campaign:0})}}function Va(t){let e,n,s,a,r,l,i,c=t[3].name+"";return{c(){e=h("button"),n=h("span"),a=p(),r=d(c),this.h()},l(t){e=$(t,"BUTTON",{class:!0});var s=g(e);n=$(s,"SPAN",{class:!0}),g(n).forEach(y),a=E(s),r=v(s,c),s.forEach(y),this.h()},h(){b(n,"class",s="mdi mdi-"+t[8](t[3])+" svelte-10e03jy"),b(e,"class","svelte-10e03jy")},m(s,c){w(s,e,c),x(e,n),x(e,a),x(e,r),l||(i=I(e,"click",t[9]),l=!0)},p(t,e){8&e&&s!==(s="mdi mdi-"+t[8](t[3])+" svelte-10e03jy")&&b(n,"class",s),8&e&&c!==(c=t[3].name+"")&&T(r,c)},d(t){t&&y(e),l=!1,i()}}}function za(t){let e,n;return{c(){e=h("span"),n=d(" Initiative"),this.h()},l(t){e=$(t,"SPAN",{class:!0}),g(e).forEach(y),n=v(t," Initiative"),this.h()},h(){b(e,"class","mdi mdi-sword-cross")},m(t,s){w(t,e,s),w(t,n,s)},p:R,d(t){t&&y(e),t&&y(n)}}}function Ba(t){let e,n,s,a,r=t[4].name+"";return{c(){e=h("span"),s=p(),a=d(r),this.h()},l(t){e=$(t,"SPAN",{class:!0}),g(e).forEach(y),s=E(t),a=v(t,r),this.h()},h(){b(e,"class",n="mdi mdi-"+t[8](t[4])+" svelte-10e03jy")},m(t,n){w(t,e,n),w(t,s,n),w(t,a,n)},p(t,s){16&s&&n!==(n="mdi mdi-"+t[8](t[4])+" svelte-10e03jy")&&b(e,"class",n),16&s&&r!==(r=t[4].name+"")&&T(a,r)},d(t){t&&y(e),t&&y(s),t&&y(a)}}}function Ha(t){let e,n,s,a,r,l,i,c=t[5].name+"";return{c(){e=h("button"),n=h("span"),a=p(),r=d(c),this.h()},l(t){e=$(t,"BUTTON",{class:!0});var s=g(e);n=$(s,"SPAN",{class:!0}),g(n).forEach(y),a=E(s),r=v(s,c),s.forEach(y),this.h()},h(){b(n,"class",s="mdi mdi-"+t[8](t[5])+" svelte-10e03jy"),b(e,"class","svelte-10e03jy")},m(s,c){w(s,e,c),x(e,n),x(e,a),x(e,r),l||(i=I(e,"click",t[10]),l=!0)},p(t,e){32&e&&s!==(s="mdi mdi-"+t[8](t[5])+" svelte-10e03jy")&&b(n,"class",s),32&e&&c!==(c=t[5].name+"")&&T(r,c)},d(t){t&&y(e),l=!1,i()}}}function Ra(t){let e,n,s;return n=new Aa({props:{campaign:t[0]}}),{c(){e=h("div"),k(n.$$.fragment),this.h()},l(t){e=$(t,"DIV",{class:!0});var s=g(e);N(n.$$.fragment,s),s.forEach(y),this.h()},h(){b(e,"class","floating svelte-10e03jy")},m(t,a){w(t,e,a),D(n,e,null),s=!0},p(t,e){const s={};1&e&&(s.campaign=t[0]),n.$set(s)},i(t){s||(O(n.$$.fragment,t),s=!0)},o(t){C(n.$$.fragment,t),s=!1},d(t){t&&y(e),A(n)}}}function qa(t){let e,n,s,a,r,l,i,c,o,u,f,d=t[2]&&Va(t);function v(t,e){return t[2]?Ba:za}let T=v(t),S=T(t),k=t[2]&&Ha(t),N=t[1]&&Ra(t);return{c(){e=h("section"),d&&d.c(),n=p(),s=h("button"),S.c(),r=p(),k&&k.c(),i=p(),N&&N.c(),c=m(),this.h()},l(t){e=$(t,"SECTION",{class:!0});var a=g(e);d&&d.l(a),n=E(a),s=$(a,"BUTTON",{class:!0});var l=g(s);S.l(l),l.forEach(y),r=E(a),k&&k.l(a),a.forEach(y),i=E(t),N&&N.l(t),c=m(),this.h()},h(){b(s,"class",a="current "+(t[1]&&"open")+" svelte-10e03jy"),b(e,"class",l="initiativeBar "+(t[2]&&"active")+" svelte-10e03jy")},m(a,l){w(a,e,l),d&&d.m(e,null),x(e,n),x(e,s),S.m(s,null),x(e,r),k&&k.m(e,null),w(a,i,l),N&&N.m(a,l),w(a,c,l),o=!0,u||(f=I(s,"click",t[7]),u=!0)},p(t,[r]){t[2]?d?d.p(t,r):(d=Va(t),d.c(),d.m(e,n)):d&&(d.d(1),d=null),T===(T=v(t))&&S?S.p(t,r):(S.d(1),S=T(t),S&&(S.c(),S.m(s,null))),(!o||2&r&&a!==(a="current "+(t[1]&&"open")+" svelte-10e03jy"))&&b(s,"class",a),t[2]?k?k.p(t,r):(k=Ha(t),k.c(),k.m(e,null)):k&&(k.d(1),k=null),(!o||4&r&&l!==(l="initiativeBar "+(t[2]&&"active")+" svelte-10e03jy"))&&b(e,"class",l),t[1]?N?(N.p(t,r),2&r&&O(N,1)):(N=Ra(t),N.c(),O(N,1),N.m(c.parentNode,c)):N&&(z(),C(N,1,1,(()=>{N=null})),B())},i(t){o||(O(N),o=!0)},o(t){C(N),o=!1},d(t){t&&y(e),d&&d.d(),S.d(),k&&k.d(),t&&y(i),N&&N.d(t),t&&y(c),u=!1,f()}}}function Ma(t,e,n){let s,a,r,l,i;var{campaign:c}=e;const{campaignStore:o}=c;ut(t,o,(t=>n(11,i=t)));var u=!1;return t.$$set=t=>{"campaign"in t&&n(0,c=t.campaign)},t.$$.update=()=>{2049&t.$$.dirty&&n(2,s=c.initiative.getCombatStarted(i)),2049&t.$$.dirty&&n(3,[a,r,l]=c.initiative.getInitiativeOverview(i),a,(n(4,r),n(0,c),n(11,i)),(n(5,l),n(0,c),n(11,i)))},[c,u,s,a,r,l,o,function(){n(1,u=!u)},function(t){return t&&"monster"===t.type?"sword-cross":"account"},function(){c.initiative.previousInitiative()},function(){c.initiative.nextInitiative()},i]}class ja extends o{constructor(t){super(),u(this,t,Ma,qa,f,{campaign:0})}}function Ua(t){let e,n,s,a,r=t[2]&&La(),l=t[3]&&Fa(),i=t[4]&&Xa(),c=t[5]&&_a();return{c(){e=h("div"),r&&r.c(),n=p(),l&&l.c(),s=p(),i&&i.c(),a=p(),c&&c.c(),this.h()},l(t){e=$(t,"DIV",{class:!0});var o=g(e);r&&r.l(o),n=E(o),l&&l.l(o),s=E(o),i&&i.l(o),a=E(o),c&&c.l(o),o.forEach(y),this.h()},h(){b(e,"class","itemsHeader svelte-t5r5z0")},m(t,o){w(t,e,o),r&&r.m(e,null),x(e,n),l&&l.m(e,null),x(e,s),i&&i.m(e,null),x(e,a),c&&c.m(e,null)},p(t,o){t[2]?r||(r=La(),r.c(),r.m(e,n)):r&&(r.d(1),r=null),t[3]?l||(l=Fa(),l.c(),l.m(e,s)):l&&(l.d(1),l=null),t[4]?i||(i=Xa(),i.c(),i.m(e,a)):i&&(i.d(1),i=null),t[5]?c||(c=_a(),c.c(),c.m(e,null)):c&&(c.d(1),c=null)},d(t){t&&y(e),r&&r.d(),l&&l.d(),i&&i.d(),c&&c.d()}}}function La(t){let e,n;return{c(){e=h("div"),n=d("Feature"),this.h()},l(t){e=$(t,"DIV",{class:!0});var s=g(e);n=v(s,"Feature"),s.forEach(y),this.h()},h(){b(e,"class","nameWrapper")},m(t,s){w(t,e,s),x(e,n)},d(t){t&&y(e)}}}function Fa(t){let e;return{c(){e=h("div"),this.h()},l(t){e=$(t,"DIV",{class:!0}),g(e).forEach(y),this.h()},h(){b(e,"class","wrapper centerText svelte-t5r5z0")},m(t,n){w(t,e,n)},d(t){t&&y(e)}}}function Xa(t){let e;return{c(){e=h("div"),this.h()},l(t){e=$(t,"DIV",{class:!0}),g(e).forEach(y),this.h()},h(){b(e,"class","wrapper centerText svelte-t5r5z0")},m(t,n){w(t,e,n)},d(t){t&&y(e)}}}function _a(t){let e;return{c(){e=h("div"),this.h()},l(t){e=$(t,"DIV",{class:!0}),g(e).forEach(y),this.h()},h(){b(e,"class","wrapper dropdownIndicatorWrapper")},m(t,n){w(t,e,n)},d(t){t&&y(e)}}}function Wa(t){let e,n,s,a,r,l,i,c,o,u,f,m,S=t[0].name+"";return{c(){e=h("div"),n=h("div"),s=h("p"),a=h("span"),l=p(),i=d(S),c=p(),o=h("p"),u=d(t[9]),this.h()},l(r){e=$(r,"DIV",{class:!0});var f=g(e);n=$(f,"DIV",{class:!0});var h=g(n);s=$(h,"P",{class:!0});var d=g(s);a=$(d,"SPAN",{class:!0}),g(a).forEach(y),l=E(d),i=v(d,S),d.forEach(y),c=E(h),o=$(h,"P",{class:!0});var p=g(o);u=v(p,t[9]),p.forEach(y),h.forEach(y),f.forEach(y),this.h()},h(){b(a,"class",r="mdi mdi-"+t[10]+" svelte-t5r5z0"),b(s,"class","spellName svelte-t5r5z0"),b(o,"class","spellDescription svelte-t5r5z0"),b(n,"class","overflowWrapper"),b(e,"class","nameWrapper svelte-t5r5z0")},m(r,h){w(r,e,h),x(e,n),x(n,s),x(s,a),x(s,l),x(s,i),x(n,c),x(n,o),x(o,u),f||(m=I(e,"click",t[11]),f=!0)},p(t,e){1024&e&&r!==(r="mdi mdi-"+t[10]+" svelte-t5r5z0")&&b(a,"class",r),1&e&&S!==(S=t[0].name+"")&&T(i,S),512&e&&T(u,t[9])},d(t){t&&y(e),f=!1,m()}}}function Ga(t){let e,n,s,a,r,l,i="monster"===t[0].dataType&&Ya(t);return{c(){e=h("div"),n=h("button"),s=h("span"),a=p(),i&&i.c(),this.h()},l(t){e=$(t,"DIV",{class:!0});var r=g(e);n=$(r,"BUTTON",{class:!0});var l=g(n);s=$(l,"SPAN",{class:!0}),g(s).forEach(y),l.forEach(y),a=E(r),i&&i.l(r),r.forEach(y),this.h()},h(){b(s,"class","mdi mdi-pin-outline svelte-t5r5z0"),b(n,"class","svelte-t5r5z0"),b(e,"class","buttonWrapper svelte-t5r5z0")},m(c,o){w(c,e,o),x(e,n),x(n,s),x(e,a),i&&i.m(e,null),r||(l=I(n,"click",t[13]),r=!0)},p(t,n){"monster"===t[0].dataType?i?i.p(t,n):(i=Ya(t),i.c(),i.m(e,null)):i&&(i.d(1),i=null)},d(t){t&&y(e),i&&i.d(),r=!1,l()}}}function Ya(t){let e,n,s,a;return{c(){e=h("button"),n=h("span"),this.h()},l(t){e=$(t,"BUTTON",{class:!0});var s=g(e);n=$(s,"SPAN",{class:!0}),g(n).forEach(y),s.forEach(y),this.h()},h(){b(n,"class","mdi mdi-sword svelte-t5r5z0"),b(e,"class","svelte-t5r5z0")},m(r,l){w(r,e,l),x(e,n),s||(a=I(e,"click",t[12]),s=!0)},p:R,d(t){t&&y(e),s=!1,a()}}}function Ja(t){let e,n,s,a,r,l,i,c=t[8]&&Ua(t),o=t[2]&&Wa(t),u=t[7]&&Ga(t);function f(e){t[17](e)}let d={entry:t[0],campaign:t[1]};return void 0!==t[6]&&(d.open=t[6]),r=new Ct({props:d}),V.push((()=>j(r,"open",f))),{c(){c&&c.c(),e=p(),n=h("div"),o&&o.c(),s=p(),u&&u.c(),a=p(),k(r.$$.fragment),this.h()},l(t){c&&c.l(t),e=E(t),n=$(t,"DIV",{class:!0});var l=g(n);o&&o.l(l),s=E(l),u&&u.l(l),l.forEach(y),a=E(t),N(r.$$.fragment,t),this.h()},h(){b(n,"class","searchResult svelte-t5r5z0")},m(t,l){c&&c.m(t,l),w(t,e,l),w(t,n,l),o&&o.m(n,null),x(n,s),u&&u.m(n,null),w(t,a,l),D(r,t,l),i=!0},p(t,[a]){t[8]?c?c.p(t,a):(c=Ua(t),c.c(),c.m(e.parentNode,e)):c&&(c.d(1),c=null),t[2]?o?o.p(t,a):(o=Wa(t),o.c(),o.m(n,s)):o&&(o.d(1),o=null),t[7]?u?u.p(t,a):(u=Ga(t),u.c(),u.m(n,null)):u&&(u.d(1),u=null);const i={};1&a&&(i.entry=t[0]),2&a&&(i.campaign=t[1]),!l&&64&a&&(l=!0,i.open=t[6],U((()=>l=!1))),r.$set(i)},i(t){i||(O(r.$$.fragment,t),i=!0)},o(t){C(r.$$.fragment,t),i=!1},d(t){c&&c.d(t),t&&y(e),t&&y(n),o&&o.d(),u&&u.d(),t&&y(a),A(r,t)}}}function Ka(t,e,n){let s,a,r,l;var{entry:i}=e,{campaign:c=M("campaign")}=e,{showName:o=!0}=e,{showHeader:u=!1}=e,{showAddButton:f=!1}=e,{showRemoveButton:h=!1}=e,{showDetails:d=!1}=e,{index:p=null}=e,{firstItem:m=!1}=e,$=!1;return t.$$set=t=>{"entry"in t&&n(0,i=t.entry),"campaign"in t&&n(1,c=t.campaign),"showName"in t&&n(2,o=t.showName),"showHeader"in t&&n(14,u=t.showHeader),"showAddButton"in t&&n(3,f=t.showAddButton),"showRemoveButton"in t&&n(4,h=t.showRemoveButton),"showDetails"in t&&n(5,d=t.showDetails),"index"in t&&n(15,p=t.index),"firstItem"in t&&n(16,m=t.firstItem)},t.$$.update=()=>{2&t.$$.dirty&&n(7,s=!!c),114688&t.$$.dirty&&n(8,a=u&&(0===p||m)),1&t.$$.dirty&&n(9,r=i.getDescription(i)),1&t.$$.dirty&&n(10,l=i.getIcon()),64&t.$$.dirty&&console.log({popupOpen:$})},[i,c,o,f,h,d,$,s,a,r,l,function(){n(6,$=!0),console.log($)},function(){c.initiative.addMonster(i)},function(){c.screens.addItemToCurrentScreen(i.name,"hashRef",i.hash)},u,p,m,function(t){n(6,$=t)}]}class Qa extends o{constructor(t){super(),u(this,t,Ka,Ja,f,{entry:0,campaign:1,showName:2,showHeader:14,showAddButton:3,showRemoveButton:4,showDetails:5,index:15,firstItem:16})}}function Za(t,e,n){const s=t.slice();return s[14]=e[n],s}function tr(t){let e,n,s,a;const r=[nr,er],l=[];function i(t,e){return t[6]?0:1}return n=i(t),s=l[n]=r[n](t),{c(){e=h("div"),s.c(),this.h()},l(t){e=$(t,"DIV",{class:!0});var n=g(e);s.l(n),n.forEach(y),this.h()},h(){b(e,"class","results svelte-dy565g")},m(t,s){w(t,e,s),l[n].m(e,null),a=!0},p(t,a){let c=n;n=i(t),n===c?l[n].p(t,a):(z(),C(l[c],1,1,(()=>{l[c]=null})),B(),s=l[n],s?s.p(t,a):(s=l[n]=r[n](t),s.c()),O(s,1),s.m(e,null))},i(t){a||(O(s),a=!0)},o(t){C(s),a=!1},d(t){t&&y(e),l[n].d()}}}function er(t){let e,n;return{c(){e=h("p"),n=d("No results")},l(t){e=$(t,"P",{});var s=g(e);n=v(s,"No results"),s.forEach(y)},m(t,s){w(t,e,s),x(e,n)},p:R,i:R,o:R,d(t){t&&y(e)}}}function nr(t){let e,n,s=t[2],a=[];for(let l=0;l<s.length;l+=1)a[l]=sr(Za(t,s,l));const r=t=>C(a[t],1,1,(()=>{a[t]=null}));return{c(){for(let t=0;t<a.length;t+=1)a[t].c();e=m()},l(t){for(let e=0;e<a.length;e+=1)a[e].l(t);e=m()},m(t,s){for(let e=0;e<a.length;e+=1)a[e].m(t,s);w(t,e,s),n=!0},p(t,n){if(5&n){let l;for(s=t[2],l=0;l<s.length;l+=1){const r=Za(t,s,l);a[l]?(a[l].p(r,n),O(a[l],1)):(a[l]=sr(r),a[l].c(),O(a[l],1),a[l].m(e.parentNode,e))}for(z(),l=s.length;l<a.length;l+=1)r(l);B()}},i(t){if(!n){for(let t=0;t<s.length;t+=1)O(a[t]);n=!0}},o(t){a=a.filter(Boolean);for(let e=0;e<a.length;e+=1)C(a[e]);n=!1},d(t){S(a,t),t&&y(e)}}}function sr(t){let e,n;return e=new Qa({props:{entry:t[14],campaign:t[0]}}),{c(){k(e.$$.fragment)},l(t){N(e.$$.fragment,t)},m(t,s){D(e,t,s),n=!0},p(t,n){const s={};4&n&&(s.entry=t[14]),1&n&&(s.campaign=t[0]),e.$set(s)},i(t){n||(O(e.$$.fragment,t),n=!0)},o(t){C(e.$$.fragment,t),n=!1},d(t){A(e,t)}}}function ar(t){let e,n,s,a,r,l,i=!t[5]&&t[3]&&tr(t);return{c(){e=h("section"),n=h("input"),s=p(),i&&i.c(),this.h()},l(t){e=$(t,"SECTION",{class:!0});var a=g(e);n=$(a,"INPUT",{class:!0,placeholder:!0}),s=E(a),i&&i.l(a),a.forEach(y),this.h()},h(){b(n,"class","searchBar svelte-dy565g"),b(n,"placeholder","Search"),b(e,"class","svelte-dy565g")},m(c,o){w(c,e,o),x(e,n),t[11](n),H(n,t[1]),x(e,s),i&&i.m(e,null),a=!0,r||(l=[I(window,"keydown",t[9]),I(n,"input",t[12]),I(n,"focus",t[8]),I(n,"keydown",t[10]),at(it.call(null,e,t[7]))],r=!0)},p(t,[s]){2&s&&n.value!==t[1]&&H(n,t[1]),!t[5]&&t[3]?i?(i.p(t,s),40&s&&O(i,1)):(i=tr(t),i.c(),O(i,1),i.m(e,null)):i&&(z(),C(i,1,1,(()=>{i=null})),B())},i(t){a||(O(i),a=!0)},o(t){C(i),a=!1},d(n){n&&y(e),t[11](null),i&&i.d(),r=!1,q(l)}}}function rr(t,e,n){let s,a,r;var{campaign:l}=e;let i,c=!1;var o="",u=Object.values(qt);return t.$$set=t=>{"campaign"in t&&n(0,l=t.campaign)},t.$$.update=()=>{2&t.$$.dirty&&n(5,s=""===o),2&t.$$.dirty&&n(2,r=Mt(u,o).filter((t=>t.score>0)).sort(((t,e)=>e.score-t.score)).slice(0,15).reverse()),4&t.$$.dirty&&n(6,a=0!==r.length),4&t.$$.dirty&&console.log(r)},[l,o,r,c,i,s,a,function(){n(3,c=!1)},function(){n(3,c=!0)},function(t){t.target instanceof HTMLInputElement||(t.preventDefault(),null==i||i.focus())},function(t){"Escape"===t.key&&(null==i||i.blur())},function(t){V[t?"unshift":"push"]((()=>{i=t,n(4,i)}))},function(){o=this.value,n(1,o)}]}class lr extends o{constructor(t){super(),u(this,t,rr,ar,f,{campaign:0})}}function ir(t){let e,n,s,a;return{c(){e=h("button"),n=h("span"),this.h()},l(t){e=$(t,"BUTTON",{class:!0});var s=g(e);n=$(s,"SPAN",{class:!0}),g(n).forEach(y),s.forEach(y),this.h()},h(){b(n,"class","mdi mdi-note-outline svelte-dzovid"),b(e,"class","svelte-dzovid")},m(r,l){w(r,e,l),x(e,n),s||(a=I(e,"click",t[0]),s=!0)},p:R,i:R,o:R,d(t){t&&y(e),s=!1,a()}}}function cr(t,e,n){var{campaign:s=M("campaign")}=e;return t.$$set=t=>{"campaign"in t&&n(1,s=t.campaign)},[function(){s.screens.addItemToCurrentScreen("New note","note",{content:""})},s]}class or extends o{constructor(t){super(),u(this,t,cr,ir,f,{campaign:1})}}const{window:ur}=ht;function fr(t){let e,n,s,a,r;return{c(){e=h("button"),n=h("span"),this.h()},l(t){e=$(t,"BUTTON",{class:!0});var s=g(e);n=$(s,"SPAN",{class:!0}),g(n).forEach(y),s.forEach(y),this.h()},h(){b(n,"class",s="mdi mdi-fullscreen"+(t[2]?"-exit":"")+" svelte-1wztidd"),b(e,"class","navButton svelte-1wztidd")},m(s,l){w(s,e,l),x(e,n),a||(r=I(e,"click",t[7]),a=!0)},p(t,e){4&e&&s!==(s="mdi mdi-fullscreen"+(t[2]?"-exit":"")+" svelte-1wztidd")&&b(n,"class",s)},d(t){t&&y(e),a=!1,r()}}}function hr(t){let e,n;return e=new or({}),{c(){k(e.$$.fragment)},l(t){N(e.$$.fragment,t)},m(t,s){D(e,t,s),n=!0},i(t){n||(O(e.$$.fragment,t),n=!0)},o(t){C(e.$$.fragment,t),n=!1},d(t){A(e,t)}}}function dr(t){let e,n,s,a,r,l,i,c,o,u,f,d,m,v,I,T,S,P,V,H=t[1].optimizedForTablet(),R=!t[1].optimizedForTablet();n=new Xt({props:{store:t[0].campaignStore}});var q=t[5];function M(t){return{props:{campaign:t[0]}}}q&&(r=new q(M(t)));let j=H&&fr(t);o=new Zs({props:{campaign:t[0]}}),f=new la({}),m=new ja({props:{campaign:t[0]}}),I=new ma({props:{campaign:t[0]}}),S=new lr({props:{campaign:t[0]}});let U=R&&hr();return{c(){e=h("main"),k(n.$$.fragment),s=p(),a=h("section"),r&&k(r.$$.fragment),l=p(),i=h("nav"),j&&j.c(),c=p(),k(o.$$.fragment),u=p(),k(f.$$.fragment),d=p(),k(m.$$.fragment),v=p(),k(I.$$.fragment),T=p(),k(S.$$.fragment),P=p(),U&&U.c(),this.h()},l(t){e=$(t,"MAIN",{class:!0});var h=g(e);N(n.$$.fragment,h),s=E(h),a=$(h,"SECTION",{class:!0});var p=g(a);r&&N(r.$$.fragment,p),p.forEach(y),l=E(h),i=$(h,"NAV",{class:!0});var b=g(i);j&&j.l(b),c=E(b),N(o.$$.fragment,b),u=E(b),N(f.$$.fragment,b),d=E(b),N(m.$$.fragment,b),v=E(b),N(I.$$.fragment,b),T=E(b),N(S.$$.fragment,b),P=E(b),U&&U.l(b),b.forEach(y),h.forEach(y),this.h()},h(){b(a,"class","mainArea svelte-1wztidd"),b(i,"class","toolBar svelte-1wztidd"),b(e,"class","svelte-1wztidd")},m(t,h){w(t,e,h),D(n,e,null),x(e,s),x(e,a),r&&D(r,a,null),x(e,l),x(e,i),j&&j.m(i,null),x(i,c),D(o,i,null),x(i,u),D(f,i,null),x(i,d),D(m,i,null),x(i,v),D(I,i,null),x(i,T),D(S,i,null),x(i,P),U&&U.m(i,null),V=!0},p(t,e){const s={};1&e&&(s.store=t[0].campaignStore),n.$set(s);const l={};if(1&e&&(l.campaign=t[0]),q!==(q=t[5])){if(r){z();const t=r;C(t.$$.fragment,1,0,(()=>{A(t,1)})),B()}q?(r=new q(M(t)),k(r.$$.fragment),O(r.$$.fragment,1),D(r,a,null)):r=null}else q&&r.$set(l);2&e&&(H=t[1].optimizedForTablet()),H?j?j.p(t,e):(j=fr(t),j.c(),j.m(i,c)):j&&(j.d(1),j=null);const u={};1&e&&(u.campaign=t[0]),o.$set(u);const f={};1&e&&(f.campaign=t[0]),m.$set(f);const h={};1&e&&(h.campaign=t[0]),I.$set(h);const d={};1&e&&(d.campaign=t[0]),S.$set(d),2&e&&(R=!t[1].optimizedForTablet()),R?U?2&e&&O(U,1):(U=hr(),U.c(),O(U,1),U.m(i,null)):U&&(z(),C(U,1,1,(()=>{U=null})),B())},i(t){V||(O(n.$$.fragment,t),r&&O(r.$$.fragment,t),O(o.$$.fragment,t),O(f.$$.fragment,t),O(m.$$.fragment,t),O(I.$$.fragment,t),O(S.$$.fragment,t),O(U),V=!0)},o(t){C(n.$$.fragment,t),r&&C(r.$$.fragment,t),C(o.$$.fragment,t),C(f.$$.fragment,t),C(m.$$.fragment,t),C(I.$$.fragment,t),C(S.$$.fragment,t),C(U),V=!1},d(t){t&&y(e),A(n),r&&A(r),j&&j.d(),A(o),A(f),A(m),A(I),A(S),U&&U.d()}}}function pr(t){let e,n,s,a,r;function l(e){t[10](e)}let i={resourceDataset:t[4],$$slots:{default:[dr]},$$scope:{ctx:t}};return void 0!==t[6].dataset&&(i.changeDataset=t[6].dataset),e=new Ft({props:i}),V.push((()=>j(e,"changeDataset",l))),{c(){k(e.$$.fragment)},l(t){N(e.$$.fragment,t)},m(n,l){D(e,n,l),s=!0,a||(r=I(ur,"fullscreenchange",t[8]),a=!0)},p(t,[s]){const a={};16&s&&(a.resourceDataset=t[4]),2087&s&&(a.$$scope={dirty:s,ctx:t}),!n&&64&s&&(n=!0,a.changeDataset=t[6].dataset,U((()=>n=!1))),e.$set(a)},i(t){s||(O(e.$$.fragment,t),s=!0)},o(t){C(e.$$.fragment,t),s=!1},d(t){A(e,t),a=!1,r()}}}function mr(t,e,n){let s,a,r,l,i,c,o=R,u=R;t.$$.on_destroy.push((()=>o())),t.$$.on_destroy.push((()=>u()));var{params:f}=e;let h=null!==document.fullscreenElement;return t.$$set=t=>{"params"in t&&n(9,f=t.params)},t.$$.update=()=>{512&t.$$.dirty&&(n(0,s=Ws(f.campaignId)),o(),o=F(s,(t=>n(1,i=t)))),2&t.$$.dirty&&(n(3,a=i.campaignStore),u(),u=F(a,(t=>n(6,c=t)))),2&t.$$.dirty&&n(4,r=i.campaignStore.get().dataset),2&t.$$.dirty&&n(5,l=i.mainManager.get().component),1&t.$$.dirty&&(window.campaign=s),1&t.$$.dirty&&K("campaign",s)},[s,i,h,a,r,l,c,async function(){h?await document.exitFullscreen():await document.body.requestFullscreen()},function(){n(2,h=null!==document.fullscreenElement)},f,function(e){t.$$.not_equal(c.dataset,e)&&(c.dataset=e,a.set(c))}]}export default class extends o{constructor(t){super(),u(this,t,mr,pr,f,{params:9})}}
